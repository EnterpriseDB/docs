---
title: 'Patroni'
description: 'Introduction to Patroni, a template to create your own high-availability solution'
tags:
  - topology
  - Patroni
indexCards: none
directoryDefaults:
  iconName: 'PostgresSupport'
  product: 'Patroni'
navigation:
- platform_support
- "#Installing"
- installing_for_epas
- installing_for_postgresql
- installing_etcd
- "#Using"
- connecting
- cluster_management
---

Patroni is among the most popular open-source tools for managing replication and failover of Postgres clusters. It relies on Postgresâ€™s streaming replication and hot standby capabilities allowing DBAs to simplify the process of setting up and managing clusters having high availability as well as read scalability requirements. Patroni is tested by EDB for use with PostgreSQL and EDB Postgres Advanced Server.

!!! Note
    Looking for Patroni documentation? Head over to [https://patroni.readthedocs.io](https://patroni.readthedocs.io/en/latest/)

## Supported topology

Patroni supports these high availability components:
* Postgres cluster: the database cluster, usually consisting of a primary and two or more replicas
* Patroni: used as the failover management utility
* etcd: used as a distributed configuration store (DCS), containing cluster information such as configuration, health, and current status

![Supported topology](images/supported-arch.png)

### Postgres

EDB currently only supports using Patroni and Postgres _physical Streaming Replication_ with a primary server and two replicas (replicating directly from the primary). EDB supports using either PostgreSQL or EDB Postgres Advanced Server.

### Patroni

Patroni is installed on the Postgres nodes. EDB supports the [latest release](https://patroni.readthedocs.io/en/latest/releases.html#releases).

### Etcd

Etcd is a strongly consistent, distributed key-value store that provides a reliable way to store data that needs to be accessed by a distributed system or cluster of machines.

Head over to [https://etcd.io](https://etcd.io/docs/) documentation for more information.

!!! Note
    For production environments, it is recommended to setup an etcd cluster of three nodes. One etcd cluster can serve multiple Postgres/Patroni clusters. Etcd nodes should be installed independently from the Postgres nodes (not on the same hosts).


See [Etcd](installing_etcd) to install and setup etcd.

### Watchdog

To avoid split-brain situations, Patroni supports [watchdog](https://patroni.readthedocs.io/en/latest/watchdog.html) devices.

Watchdog devices are software or hardware mechanisms that will reset the whole system when they do not get a keepalive heartbeat within a specified timeframe. This adds an additional layer of fail safe in case usual Patroni split-brain protection mechanisms fail.

!!! Note
    While the use of a watchdog mechanism with Patroni is optional, it is recommended to use it for production environments.


## HAProxy

Instead of connecting directly to the database server, it is possible to setup HAProxy so the application will be connecting to the proxy instead, which will then forward the request to Postgres. When HAProxy is used for this, it is also possible to route read-only requests to one or more replicas, for load balancing.

HAProxy can be installed as an independent server but it can also be installed on the application server or the database server itself.

!!! Note
    For production environments, it is recommended to setup at least two HAProxy servers. Using various ports, one HAProxy server can serve multiple Postgres/Patroni clusters.


## Security considerations

Security considerations are beyond the scope of this documentation but more details about the distributed configuration storage (DCS) and the Patroni REST API can be found in the [patroni official documentation](https://patroni.readthedocs.io/en/latest/security.html).

HTTPS can also be used with HAProxy while not covered in this guide.
