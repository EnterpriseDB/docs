---
title: Installing FlowServer for WarehousePG
navTitle: Installing
description: Learn how to install FlowServer for WarehousePG.
---

The FlowServer service can run on any host that is able to reach your WHPG cluster. However, you must also install the packages on every host in your WHPG cluster.

## Prerequisites

- WarehousePG (WHPG) version 6.x running on RH7 or RH8.
- WarehousePG version 7.x running on RH8 or RH9.

## Network requirements

The following table lists the connection requirements among the different components. Note that the ports listed are default values, you can customize them according to your environment:

| Source | Destination | Use  
| ------ | ----------- | ---


## Download and install the package on your WarehousePG cluster

1. Download the package from the EDB repository:

    ```bash
    export EDB_SUBSCRIPTION_TOKEN=<your-token>
    export EDB_REPO=gpsupp
    curl -1sSLf "https://downloads.enterprisedb.com/$EDB_SUBSCRIPTION_TOKEN/$EDB_REPO/setup.rpm.sh" | sudo -E bash
    sudo dnf download whpg<whpg_major_version>-flow-server
    ```
 
 Where `<whpg_major_version>` is your WHPG version (6 or 7).

1. Create a file `all_hosts` on your WHPG coordinator, which lists all hosts in the WHPG cluster. For example:

    ```ini
    cdw
    scdw
    sdw1
    sdw2
    sdw3
    ```

1. From the coordinator, use the `gpssh` utility to install the packages from the coordinator onto every other host in the cluster:

    <TabContainer syncKey="install">
    <Tab title="RHEL 8, 9">

    ```bash 
    gpssh -f all_hosts -e 'sudo dnf install -y whpg<whpg_major_version>-flow-server'
    ```

    </Tab>
    <Tab title="RHEL 7">

    ```bash 
    gpssh -f all_hosts -e 'sudo yum install -y whpg<whpg_major_version>-flow-server'
    ```

    </Tab>
    </TabContainer>

1. Create the FlowServer extension by connecting to a database on your WHPG cluster and running:

```SQL
CREATE EXTENSION whpg_flow_server;
```

## Download and install the package on your dedicated FlowServer host

If you are running FlowServer on a different host to your WHPG cluster, you must download and install the packages there too:

1. Download the package from the EDB repository:

    ```bash
    export EDB_SUBSCRIPTION_TOKEN=<your-token>
    export EDB_REPO=gpsupp
    curl -1sSLf "https://downloads.enterprisedb.com/$EDB_SUBSCRIPTION_TOKEN/$EDB_REPO/setup.rpm.sh" | sudo -E bash
    sudo dnf download whpg<whpg_major_version>-flow-server
    ```

1. Install the package on the FlowServer dedicated host:

    <TabContainer syncKey="install">
    <Tab title="RHEL 8, 9">

    ```bash 
    sudo dnf install -y whpg<whpg_major_version>-flow-server
    ```

    </Tab>
    <Tab title="RHEL 7">

    ```bash 
    sudo yum install -y whpg<whpg_major_version>-flow-server
    ```

    </Tab>
    </TabContainer>

## Configure FlowServer

Edit the configuration file `flow_server.json` on the host that will be running the FlowServer service. This might be the host within your WHPG cluster, or a dedicated server.

```ini
{
    "Host": "",
    "Port": 6060,
    "Gpfdist": {
        "Host": "",
        "Port": 6070,
        "ReuseTables": true
    },
    "Prometheus": {
        "Host": "",
        "Port": 9080,
        "MetricsPath": "/flow_metrics"
    },
    "DebugPort": 6080,
    "Logging": {
        "SplitLogByJob": false,
        "FrontendLevel": "debug",
        "BackendLevel": "info"
    }
}
```

Where:
 - `Host`: The hostname or IP address of the server. The default is an empty string, which means it will listen on all interfaces.
 - `Port`: The port number on which the server listens for incoming connections. The default is 6060.
 - `Gpfdist`: Configuration options for the gpfdist service.
     - `Host`: The hostname or IP address of the gpfdist service. The default is an empty string, which means it will listen on all interfaces.
     - `Port`: The port number on which the gpfdist service listens. The default is 6070.
     - `ReuseTables`: Whether to reuse existing tables in the database. The default is false, not reuse the external table. When you reuse external tables, flow server generates the external table name using a hash of various load configuration property values. By default, flow server drops the external table associated with a load operation (if one exists) and creates a new external table when you (re)start the job. If you do not reuse external tables, the external table name is based on the job name.
 - `Prometheus`: Configuration options for the Prometheus metrics endpoint.
     - `Host`: The hostname or IP address of the Prometheus service. The default is an empty string, which means it will listen on all interfaces.
     - `Port`: The port number on which the Prometheus service listens.
     - `MetricsPath`: The path to the metrics endpoint.
 - `DebugPort`: The port number for the debug server.
 - `Logging`: Configuration options for logging. The valid log levels are debug, info, warn, error and fatal.
     - `SplitLogByJob`: Whether to split logs by job. The default is true, meaning logs will be separated by job.
     - `FrontendLevel`: The logging level for the frontend/stdout. The default is "info".
     - `BackendLevel`: The logging level for the backend/log file. The default is "debug".

## Start the FlowServer service:

Once you have configured the settings, start FlowServer on the host that will be running the FlowServer service:

```bash
./flowserver -c configs/flow_server.json
```

