---
title: CVE-2024-4317 - Restrict visibility of "pg_stats_ext" and "pg_stats_ext_exprs" entries to the table owner
navTitle: CVE-2024-4317
affectedProducts: All versions of PostgreSQL, EPAS and PGE prior to 16.3, 15.7, and 14.12
---

First Published: 2024/05/09

Last Updated: 2024/05/09

Important: This is an assessment of the impact of CVE-2024-4317 on EDB products and services. It links to and details the CVE and supplements that information with EDB's own assessment.

## Summary 

Missing authorization in PostgreSQL built-in views pg_stats_ext and pg_stats_ext_exprs allows an unprivileged database user to read most common values and other statistics from CREATE STATISTICS commands of other users. The most common values may reveal column values the eavesdropper could not otherwise read or results of functions they cannot execute. Installing an unaffected version only fixes fresh PostgreSQL installations, namely those that are created with the initdb utility after installing that version. Current PostgreSQL installations will remain vulnerable until they follow the instructions in the release notes, which are provided as a convenience in the below section. Within major versions 14-16, minor versions before PostgreSQL 16.3, 15.7, and 14.12 are affected. Versions before PostgreSQL 14 are unaffected.


## Vulnerability details

CVE-ID:  [CVE-2024-4317](https://www.postgresql.org/support/security/CVE-2024-4317/)

CVSS Base Score: 3.1

CVSS Temporal Score: Undefined

CVSS Environmental Score: Undefined

CVSS Vector: [AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N&version=3.0)

## Affected products and versions

### PostgreSQL

* All versions of PostgreSQL prior to 16.3
* All versions of PostgreSQL prior to 15.7
* All versions of PostgreSQL prior to 14.12

### EnterpriseDB Postgres Advanced Server (EPAS)

* All versions of EPAS prior to 16.3
* All versions of EPAS prior to 15.7
* All versions of EPAS prior to 14.12

### EnterpriseDB Postgres Extended

* All versions of PGE prior to 16.3
* All versions of PGE prior to 15.7
* All versions of PGE prior to 14.12

## Remediation/fixes

The fix is included in the following versions: 16.3, 15.7, and 14.12.

Installing the fix will not remove the vulnerability from existing installations. To remove the vulnerability, follow the instructions in the [CVE-2024-4317](https://www.postgresql.org/support/security/CVE-2024-4317/) advisory.
    
### PostgreSQL Version Information

| Affected Version            | Fixed In | Fix Published |
|-----------------------------|----------|---------------|
| All versions prior to 16.3  | 16.3     | 2024-05-09    |
| All versions prior to 15.7  | 15.7     | 2024-05-09    |
| All versions prior to 14.12 | 14.12    | 2024-05-09    |

### EPAS Version Information

| Product | VRMF                           | Remediation/First Fix                                                                                                                        |
|---------|--------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| EPAS    | All versions prior to 16.3     | Update to version 16.3 or later                                                                                                              |
| EPAS    | All versions prior to 15.7     | Update to version 15.7 or later                                                                                                              |
| EPAS    | All versions prior to 14.12    | Update to version 14.12 or later                                                                                                             |

### PGE Version Information

| Product | VRMF                           | Remediation/First Fix                                                                                                                      |
|---------|--------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|
| PGE     | All versions prior to 16.3     | Update to version 16.3 or later                                                                                                            |
| PGE     | All versions prior to 15.7     | Update to version 15.7 or later                                                                                                            |
| PGE     | All versions prior to 14.12    | Update to version 14.12 or later                                                                                                           |

## References

* [CVSS Calculator v3.1](https://www.first.org/cvss/calculator/3.1)
* [CWE-284 Improper Access Control](http://cwe.mitre.org/data/definitions/284.html)

## Related information

* [EnterpriseDB](https://www.enterprisedb.com/)
* [EDB Blogs link](https://enterprisedb.com/blog/)

## Acknowledgement

Source: PostgreSQL.org

## Change history

9 May 2024: Original Copy Published

## Disclaimer

This document is provided on an "as is" basis and does not imply any kind of
guarantee or warranty, including the warranties of merchantability or fitness
for a particular use. Your use of the information on the document is at your own
risk. EDB reserves the right to change or update this document at any time.
Customers are therefore recommended to always view the latest version of this
document.
