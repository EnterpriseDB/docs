---
title: "Pipelines - PGFS"
navTitle: "PGFS"
description: "How to work with the PGFS (Postgres File System) in Pipelines."
---

Pipelines has a "Postgres File System" (PGFS) extension that allows you to access external storage. In particular, it allows you to store and retrieve files from either a public or private S3-compatible bucket or a local file system. The aidb extension addresses external storage mapped through pgfs as "storage locations" and abstracts away the details of the underlying storage.

PGFS is a key component of Pipelines, allowing you to work with data which is not stored in the database, either because it is too large or because it is not structured in a way that is suitable for a relational database.

PGFS is implemented as a foreign data wrapper (FDW) and is installed as an extension. The extension provides a set of functions to interact with the file system from within the database.

## Installing the PGFS extension

See [Installing](../installing) for instructions on how to install the PGFS extension as part of the Pipelines installation.

## Using PGFS

There are two approaches to using PGFS. You can use the PGFS functions to create and delete storage locations, or you can use the `CREATE SERVER` command to create a server object that connects to the storage location.

### Using the PGFS functions

The PGFS extension provides a set of functions to create and manage storage locations.

We start with creating a storage location. A storage location is a reference to a location in an external file system. You can create a storage location with the `pgfs.create_storage_location` function.

```sql
select pgfs.create_storage_location('my_storage', 's3://my_bucket');
```

The create_strorage_location function takes a name for the storage location and then a URL for the location. The URL should be prefixed with `s3:` for an S3-compatible bucket or `file:` for a local file system.

The function also takes an optional `msl_id` parameter, which is not used.

There are two other optional parameters, `options` and `credentials`. 
The `options` parameter is a JSON object that can be used to pass additional options to the storage location.
The `credentials` parameter is a JSON object that can be used to pass credentials to the storage location.

For example, you can create a storage location with options and credentials like this:

```sql
select pgfs.create_storage_location('my_storage', 's3://my_private_bucket', null, '{"region": "eu-west"}'::JSONB, '{"access_key_id": "youraccesskeyid", "secret_access_key":"yoursecretaccesskey"}'::JSONB);
```

### Using the `CREATE SERVER` command

You can also use the `CREATE SERVER` command to create a server object that connects to the storage location. You can then create a foreign table that is associated with the server.

Here is an example of creating a server object that connects to an S3-compatible bucket:

```sql
CREATE SERVER my_server FOREIGN DATA WRAPPER pgfs OPTIONS (url 's3://my_bucket');
```

### Options and Credentials

There are various options and credentials that you can pass to the storage locations.
The options and credentials are specific to the type of storage location you are using.

- [S3-compatible storage](s3)
- [Local file system](local)


