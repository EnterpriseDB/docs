---
title: "Modifying the data directory location"
---

## On RHEL/CentOS 7.x or RHEL/Rocky Linux/AlmaLinux 8.x

On a RHEL/CentOS 7.x or RHEL/Rocky Linux/AlmaLinux 8.x host, the unit file is named `edb-as-<xx>.service`, where `<xx>` is the EDB Postgres Advanced Server version. It resides in `/usr/lib/systemd/system`. The unit file contains references to the location of the EDB Postgres Advanced Server `data` directory.

!!! Important
You should never make changes to files residing in `/usr/lib/systemd/system` or `/lib/systemd/system`, as they are provided by EDB packages.
!!!

By default, data files reside under the `/var/lib/edb/as15/data` directory. To use a data directory that resides in a nondefault location, perform the following steps:

-   Edit the database service using `systemctl edit`:

    ```shell
    systemctl edit edb-as-15.service
    ```

    This will open a text editor (usually nano or vi, depending on your `EDITOR` environment variable and your distribution defaults).

-   In the text editor, add the lines:

    ```ini
    [Service]
    Environment=PGDATA=/var/lib/edb/as15/data
    PIDFile=/var/lib/edb/as15/data/postmaster.pid
    ```

    Note: In the lines above, replace `/var/lib/edb/as15/data` with the desired location for your data directory.

-   Save the file

    Note: when editing systemd units using `systemd edit`, there is no need to reload the daemon, as systemd does it automatically as you exit the editor.

-   Initialize the cluster at the new location:

    ```text
    PGSETUP_INITDB_OPTIONS="-E UTF-8" /usr/edb/as15/bin/edb-as-15-setup initdb
    ```

-   Start the EDB Postgres Advanced Server service:

    ```text
    systemctl start edb-as-15
    ```

## Configuring SELinux policy to change the data directory location on RHEL/CentOS 7.x or RHEL/Rocky Linux/AlmaLinux 8.x

By default, the data files reside under the `/var/lib/edb/as15/data` directory. To change the default data directory location depending on individual environment preferences, you must configure the SELinux policy:

-   Stop the server:

    ```text
    systemctl stop edb-as-15
    ```

-   Check the status of SELinux using the `getenforce` or `sestatus` command:

    ```text
    # getenforce
    Enforcing

    # sestatus
    SELinux status:                 enabled
    SELinuxfs mount:                /sys/fs/selinux
    SELinux root directory:         /etc/selinux
    Loaded policy name:             targeted
    Current mode:                   enforcing
    Mode from config file:          enforcing
    Policy MLS status:              enabled
    Policy deny_unknown status:     allowed
    Max kernel policy version:      31
    ```

-   View the SELinux context of the default database location:

    ```text
    ls -lZ /var/lib/edb/as15/data
    drwx------. enterprisedb enterprisedb unconfined_u:object_r:var_lib_t:s0 log
    ```

-   Create a directory for a new location of the database:

    ```text
    mkdir /opt/edb
    ```

-   Move the data directory to `/opt/edb`:

    ```text
    mv /var/lib/edb/as15/data /opt/edb/
    ```

-   Edit the database service using `systemctl edit`:

    ```shell
    systemctl edit edb-as-15.service
    ```

    This will open a text editor (usually nano or vi, depending on your `EDITOR` environment variable and your distribution defaults).

-   In the text editor, add the lines:

    ```ini
    [Service]
    Environment=PGDATA=/opt/edb/data
    PIDFile=/opt/edb/data/postmaster.pid
    ```

-   Save the file

    Note: when editing systemd units using `systemd edit`, there is no need to reload the daemon, as systemd does it automatically as you exit the editor.

-   Use the `semanage` utility to set the context mapping for `/opt/edb/`. The mapping is written to the `/etc/selinux/targeted/contexts/files/file.contexts.local` file.

    ```text
    semanage fcontext --add --equal /var/lib/edb/as15/data /opt/edb
    ```

-   Apply the context mapping using the restorecon utility:

    ```text
    restorecon -rv /opt/edb/
    ```

-   With the `/opt/edb` location labeled correctly with the context, start the service:

    ```text
    systemctl start edb-as-15
    ```
