---
title: "DBMS_JOB"
legacyRedirectsGenerated:
  # This list is generated by a script. If you need add entries, use the `legacyRedirects` key.
  - "/edb-docs/d/edb-postgres-advanced-server/user-guides/database-compatibility-for-oracle-developers-built-in-package-guide/9.6/Database_Compatibility_for_Oracle_Developers_Built-in_Package_Guide.1.16.html"
  - "/edb-docs/d/edb-postgres-advanced-server/user-guides/database-compatibility-for-oracle-developers-guide/9.5/Database_Compatibility_for_Oracle_Developers_Guide.1.192.html"
  - "/edb-docs/d/edb-postgres-advanced-server/user-guides/user-guide/9.5/EDB_Postgres_Enterprise_Guide.1.150.html"
redirects:
  - /epas/latest/epas_compat_bip_guide/03_built-in_packages/05_dbms_job/ #generated for docs/epas/reorg-role-use-case-mode
---

The `DBMS_JOB` package lets you create, schedule, and manage jobs. A job runs a stored procedure that was previously stored in the database. The `SUBMIT` procedure creates and stores a job definition. A job identifier is assigned to a job with a stored procedure and the attributes describing when and how often to run the job.

EDB Postgres Advanced Server's implementation of `DBMS_JOB` is a partial implementation when compared to Oracle's version. The following table lists the supported `DBMS_JOB` procedures.

| Function/procedure                                               | Return type | Description                                                                                                                                                 |
| ---------------------------------------------------------------- | ----------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `BROKEN(job, broken [, next_date ])`                             | n/a         | Specify that a given job is either broken or not broken.                                                                                                    |
| `CHANGE(job, what, next_date, interval, instance, force)`        | n/a         | Change the jobâ€™s parameters.                                                                                                                                |
| `INTERVAL(job, interval)`                                        | n/a         | Set the execution frequency by means of a date function that is recalculated each time the job is run. This value becomes the next date/time for execution. |
| `NEXT_DATE(job, next_date)`                                      | n/a         | Set the next date/time to run the job.                                                                                                                |
| `REMOVE(job)`                                                    | n/a         | Delete the job definition from the database.                                                                                                                |
| `RUN(job)`                                                       | n/a         | Force execution of a job even if it's marked broken.                                                                                                      |
| `SUBMIT(job OUT, what [, next_date [, interval [, no_parse ]]])` | n/a         | Create a job and store its definition in the database.                                                                                                    |
| `WHAT(job, what)`                                                | n/a         | Change the stored procedure run by a job.                                                                                                                   |


To use `DBMS_JOB`,

1. Set the GUC parameter and the shared libraries parameter in `postgresql.conf` file:

   ```ini
   edb_job_scheduler.database_list = 'edb,regression,ds_db'
   shared_preload_libraries='$libdir/edb_job_scheduler' 
   ```

2. Restart the EPAS server.

3. Create the extension:

   ```sql
   # Connect to your database using psql as superuser
   psql -d edb -U enterprisedb
   # Create the extension
   CREATE EXTENSION edb_job_scheduler;
   ```

When and how often a job runs depends on two interacting parameters: `next_date` and `interval`. The `next_date` parameter is a date/time value that specifies the next date/time to execute the job. The `interval` parameter is a string that contains a date function that evaluates to a date/time value.

Before the job executes, the expression in the `interval` parameter is evaluated. The resulting value replaces the `next_date` value stored with the job. The job is then executed. In this manner, the expression in `interval` is repeatedly reevaluated before each job executes, supplying the `next_date` date/time for the next execution.

The following examples use the stored procedure `job_proc`. The procedure inserts a timestamp into the table `jobrun`, which contains a single column, `VARCHAR2`.

```sql
CREATE TABLE jobrun (
    runtime VARCHAR2(40)
);

CREATE OR REPLACE PROCEDURE job_proc
IS
BEGIN
    INSERT INTO jobrun VALUES ('job_proc run at ' || TO_CHAR(SYSDATE,
        'yyyy-mm-dd hh24:mi:ss'));
END;
```

The EDB Job Scheduler is an extension that runs a job scheduler as a background process for the `DBMS_JOB` package. For the extension to operate, make sure to follow the instructions for using `DBMS_JOB`. If these instructions are followed, the job scheduler process first starts when the database cluster loads. 

To learn about future jobs and job statuses, see the two tables in `sys` schema: 

- `jobs` &mdash; Contains the information about future jobs. For example:

  ```
     Column   |           Type
  ------------+--------------------------
   jobid      | bigint
   jobnextrun | timestamp with time zone
   jobcommand | text
   jobuser    | text
  ```

- `job_run_details` &mdash; Contains the job run status. The `status` can be `'r' - running`, `'s' - success`, or `'f' - failure` for the respective `jobid`. For example: 
  ```
      Column    |           Type
  --------------+--------------------------
   jobid        | bigint
   runid        | bigint
   username     | text
   workerpid    | integer
   status       | character(1)
   error        | text
   scheduletime | timestamp with time zone
   starttime    | timestamp with time zone
   endtime      | timestamp with time zone
  ```

To configure the job scheduler, use these GUCs: 

- `edb_job_scheduler.max_jobs_per_database` &mdash; Controls the maximum number of jobs per database level. 
- `edb_job_scheduler.max_workers_per_database` &mdash; Controls the maximum number of worker processes per database level.

The extension offers these user API functions: 

- `sys.reload_all_jobs` &mdash; Reloads all the unscheduled jobs from the current database. 

  !!! Note
     This function requests only the scheduler process. So, if the local storage of the scheduler limit meets the maximum set by `edb_job_scheduler.max_jobs_per_database`, the loading fails. 

- `sys.dump_schedule()` &mdash; Displays the current job schedule from the scheduler's local memory. The scheduler's local memory dumps all the jobs that have yet to be executed into the server log in JSON format. 

<div class="toctree" maxdepth="5">

broken change interval next_date remove run submit what

</div>
