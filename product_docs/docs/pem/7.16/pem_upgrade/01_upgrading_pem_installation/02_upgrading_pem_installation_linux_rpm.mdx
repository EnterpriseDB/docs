---
title: "Upgrading a PEM Native Package Installation on a Linux Host"
---

To upgrade PEM component software on Linux hosts, simply install a newer version of the PEM component native packages in the following order:

1.  Invoke the PEM agent native package installer on each monitored node `except` the PEM server host.
2.  Invoke the PEM server native package installer; it will upgrade `both` the PEM server and the PEM agent that resides on the PEM server host.

During an installation, the component installation will automatically detect an existing installation, and perform an upgrade. After upgrading the PEM agent and server, you can upgrade SQL Profiler if required; this step is platform-specific.

!!! Note
    If you have already configured or are planning to configure any shell/batch script run by a Linux agent that is upgraded from any lower version to 7.11 or later version, the user for the `batch_script_user` parameter must be specified in the `agent.cfg` file. It is strongly recommended that a non-root user is used to run the scripts. Using the root user may result in compromising the data security and operating system security. However, if you want to restore the `pemagent` to its original settings using a root user to run the scripts, then the `batch_script_user` parameter value must be set to `root`.

The following sections will walk you through the upgrade process on a Linux host, step-by-step.

## Prerequisites to Upgrade a PEM Installation on Linux Host

PEM is dependent on third-party components from the vendor repository, including the python3, libboost, openssl, snmp++, libcurl, etc. To ensure these components are up to date, you should update your operating system using following platform-specific commands. Minimum version require for openssl is 1.0.2k. If you are using a version of PostgreSQL or Advanced Server older than version 10, before the upgrade you must install the `libs` package for version 10 or above on the system where the PEM server is installed. Use the following platform-specific commands to install the `libs` version 10 or above on your host:

### Prerequisites to Upgrade a PEM Installation on a CentOS or RHEL Host

To upgrade packages on a CentOS or RHEL 7.x host

```text
yum upgrade
```

To upgrade packages on a CentOS or RHEL 8.x host

```text
dnf upgrade
```

To upgrade Advanced Server libs:

```text
yum install edb-as<X>-server-libs
```

To upgrade PostgreSQL libs:

```text
yum install postgresql<X>-libs
```

Where `<X>` is the PostgreSQL or Advanced Server version whose `libs` package you want to install.

### Prerequisites to Upgrade a PEM Installation on a Debian or Ubuntu Host

To upgrade packages on a Debian or Ubuntu host

```text
apt-get update
```

To upgrade Advanced Server libs:

```text
apt-get install edb-as<X>-server-libs
```

To upgrade PostgreSQL libs:

```text
apt-get install postgresql<X>-libs
```

Where `<X>` is the PostgreSQL or Advanced Server version whose `libs` package you want to install.

### Prerequisites to Upgrade a PEM Installation on a SLES Host

To upgrade packages on a SLES host

```text
zypper update
```

To upgrade Advanced Server libs:

```text
zypper install edb-as<x>-server-libs
```

To upgrade PostgreSQL libs:

```text
zypper install postgresql<x>-libs
```

Where `<X>` is the PostgreSQL or Advanced Server version whose `libs` package you want to install.

## Upgrading a PEM Agent Native Package Installation

You can use native packages to upgrade existing PEM Agents that were initially installed using native packages. The upgrade process does not update the PEM agent configuration file. After installing the new agent, you must manually copy the configuration file of the existing agent to the new installation location.

### Upgrading the PEM Agent on a CentOS or RHEL Host

For CentOS or RHEL 7.x or 8.x:

To upgrade a PEM agent, use the following command:

```text
yum upgrade edb-pem-agent
```

For CentOS or RHEL 8.x, you can also use the following command:

```text
dnf upgrade edb-pem-agent
```

### Upgrading a PEM Agent on a Debian or Ubuntu Host

To upgrade a PEM Agent, use the following command:

```text
apt-get upgrade edb-pem-agent
```

### Upgrading a PEM Agent on a SLES Host

To upgrade a PEM Agent, use the following command:

```text
zypper update edb-pem-agent
```

## Upgrading a PEM Server Native Package Installation

If you initially used native packages to install your PEM server, you can use native packages to upgrade your PEM server. The commands to upgrade are platform-specific; please refer to your platform's section below.

If you wish to upgrade a PEM server that is installed on a machine in an isolated network, you need to create a PEM repository on that machine before you upgrade the PEM server. For more information about creating a PEM repository on an isolated network, see [Creating a PEM Repository on an Isolated Network](03_creating_pem_repository_in_isolated_network/#creating_pem_repository_in_isolated_network).

### Upgrading a PEM Server on a CentOS or RHEL Host

To use an RPM package to upgrade an existing RPM installation you must:

You can use the `yum` package manager to upgrade the installed version of the PEM server on CentOS or RHEL 7.x or 8.x:

```text
yum upgrade edb-pem
```

You can also use the `dnf` command on CentOS or RHEL 8.x:

```text
dnf upgrade edb-pem
```

!!! Note
    If you are doing a fresh installation of the PEM Server on CentOS or RHEL 7.x host, the installer will install the edb-python3-mod_wsgi package along with the installation as the package is a requirement of the operating system. If you are *upgrading* the PEM Server on CentOS or RHEL 7.x host, the mod_wsgi package will be replaced by the edb-python3-mod_wsgi package to meet the requirements of the operating system.

After upgrading the PEM Server using `yum` or `dnf`, you must configure the PEM Server. For more detailed information see [Configuring the PEM Server on Linux Platforms](05_configuring_the_pem_server_on_linux_platforms/#configuring_the_pem_server_on_linux_platforms).

### Upgrading the PEM Server on a Debian or Ubuntu Host

You can use the `apt-get` package manager to upgrade the installed version of the PEM Server on supported versions of Debian or Ubuntu:

```text
apt-get upgrade edb-pem
```

After upgrading the PEM Server with `apt-get`, you need to configure the PEM Server. For more detailed information see [Configuring the PEM Server on Linux Platforms](05_configuring_the_pem_server_on_linux_platforms/#configuring_the_pem_server_on_linux_platforms).

### Upgrading the PEM Server on a SLES Host

You can use the `zypper` package manager to upgrade the installed version of the PEM Server on supported versions of SLES Host:

```text
zypper update edb-pem
```

After upgrading the PEM Server using `zypper`, you need to configure the PEM Server. For more detailed information see [Configuring the PEM Server on Linux platforms](05_configuring_the_pem_server_on_linux_platforms/#configuring_the_pem_server_on_linux_platforms).

## Upgrading a SQL Profiler Native Package Installation

To upgrade a SQL Profiler installation that resides on a Linux host:

1.  Delete the existing SQL Profiler query set on each node by invoking the `uninstall-sql-profiler.sql` script. By default, on a Linux host the script resides in the `share/contrib` directory under your Advanced Server or PostgreSQL installation.

    You can use the following server-specific command:

    For PostgreSQL:

    ```text
    /usr/pgsql-<x>/bin/psql -f /usr/pgsql-<x>/share/contrib/uninstall-sql-profiler.sql -d postgres -U postgres
    ```

    Where, `x` is the version of PostgreSQL and `-d` specifies the name of the maintenance database.

    For Advanced Server:

    ```text
    /usr/edb/as<x>/bin/psql -f /usr/edb/as<x>/share/contrib/uninstall-sql-profiler.sql -d edb -U enterprisedb
    ```

    Where, `x` is the version of Advanced Server and `-d` specifies the name of the maintenance database.

2.  Invoke the new SQL Profiler installer on each node you wish to profile.

    For PostgreSQL:

    ```text
    yum upgrade postgresql<x>-sqlprofiler
    ```

    Where, `x` is the version of the PostgreSQL.

    For Advanced Server:

    ```text
    yum upgrade edb-as<x>-server-sqlprofiler
    ```

    Where `x` is the version of Advanced Server.

The installer will detect the existing `SQL Profiler` installation and upgrade with the latest version of SQL Profiler.

Please see the following example of upgrading SQL Profiler for PostgreSQL:

![Upgrading SQL Profiler](../../images/sqlprofiler_upgrade.png)

3.  Then, run the `sql-profiler.sql` script file in the maintenance database.

    For PostgreSQL:

    ```text
    /usr/pgsql-<x>/bin/psql -f /usr/pgsql-<x>/share/contrib/sql-profiler.sql -d postgres -U postgres
    ```

    Where, `x` is the version of PostgreSQL and `-d` specifies the name of the maintenance database.

    For Advanced Server:

    ```text
    /usr/edb/as<x>/bin/psql -f /usr/edb/as<x>/share/contrib/sql-profiler.sql -d edb -U enterprisedb
    ```

    Where, `x` is the version of Advanced Server and `-d` specifies the name of the maintenance database.

4.  Restart the PostgreSQL/Advanced Server to resume profiling the node from the PEM Client.

After updating the PEM components, you are ready to update the backend database.
