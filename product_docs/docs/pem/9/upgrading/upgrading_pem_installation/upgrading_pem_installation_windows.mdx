---
title: "Upgrading a PEM installation on a Windows host"
legacyRedirectsGenerated:
  # This list is generated by a script. If you need add entries, use the `legacyRedirects` key.
  - "/edb-docs/d/edb-postgres-enterprise-manager/installation-getting-started/upgrade-migration-guide/8.0/upgrading_pem_installation_windows.html"
redirects:
- /pem/latest/pem_upgrade/01_upgrading_pem_installation/06_upgrading_pem_installation_windows/
- /pem/latest/pem_upgrade/upgrading_pem_installation/upgrading_pem_installation_windows/
---

To upgrade PEM component software on Windows hosts, invoke a newer version of the PEM component installers in the following order:

1.  Invoke the PEM agent installer on each monitored node except the PEM server host.
2.  Invoke the PEM server installer. This installer upgrades both the PEM server and the PEM agent that resides on the PEM server host.

During an installation, the component installer automatically detects an existing installation and performs an upgrade. After upgrading the PEM gent and server, you can upgrade SQL profiler if required. This step is platform specific.

## Upgrading a PEM agent on a Windows host

To upgrade a system that is currently monitored by a PEM agent to a more recent PEM agent, download and invoke a newer version of the PEM Agent installer on the system that the agent is monitoring.

1.  To invoke the installer, right-click the downloaded installer icon and select **Run as Administrator**. The PEM Agent Setup wizard opens, welcoming you.

1.  Read and accept the license agreement and then select **Next**.

1.  The setup wizard automatically detects an existing agent and upgrades the installed version. Select **Next**.

1.  The pemAgent Service Account dialog box might prompt you for the password of the account under which the PEM agent service runs. If prompted, provide the password, and select **Next**.

1.  When the Ready to Install dialog box informs you that the installation is about to begin, select **Next**. The wizard upgrades your PEM agent to the latest version.

1.  The PEM Agent Setup wizard informs you when the installation completes. Select **Finish**.

1.  After the installation completes, you're prompted to restart the machine. Select **Yes** to restart the machine and the PEM agent.

## Upgrading the PEM server on a Windows host

The PEM server installer enables you to upgrade between major versions of the PEM server. You can upgrade from version 5.0 to version 7.16 without first upgrading to version 6.0.

1.  To invoke the installer, right-click the downloaded installer, and select **Run as Administrator**.

1.  The PEM Server Setup wizard welcomes you. Select **Next**.

1.  The PEM Server Setup wizard prompts you to accept the license agreement. After reviewing the license agreement, select **I accept the agreement** and select **Next**.

1.  The wizard checks the PEM server host for an existing PEM server installation. If the wizard locates an installation, it performs an upgrade. Select **Next**.

  Before upgrading the PEM server, the wizard confirms that the requirements of the new PEM server are present. If any supporting components are missing or are at a version that doesn't support the new PEM installation, the wizard informs you that it must upgrade the dependencies. It then invokes the required installers.

1.  When the installation wizards completes the dependency upgrades, you're prompted to restart the machine. Select **No** to continue the upgrade process.

1.  The wizard then opens the Database Server Installation Details dialog box, prompting you for connection credentials for the database superuser of the PEM backend database. Provide:

  -   The name of the database superuser in the **User** field.
  -   The password associated with the database superuser in the **Password** field.

  Select **Next**.

1.  The pemAgent Service Account dialog box might prompt you for the password of the account under which the PEM agent service runs. If prompted, provide the password, and select **Next**.

1.  The Ready to Install dialog box informs you that the setup wizard is ready to perform the installation. Select **Next** to start the installation.

  After upgrading the PEM server (and the agent that resides on the same host as the PEM server) and configuring the web service, the PEM setup wizard notifies you of the port on which the service is listening. Use this port number when connecting to the PEM server with the PEM client.

1.  Select **OK**. The PEM server setup wizard informs you that the installation is complete.

1.  If you're prompted to restart the machine, select **Yes** to restart the machine and the httpd service.

If you installed the PEM backend database server and PEM-HTTPD on different hosts, then you must run the PEM server installer twice: once on each host. Extract the language pack installer, and install it on the host of PEM-HTTPD before invoking the PEM installer. Include the following keywords when invoking the installer to extract the language pack:

`--extract-languagepack <path>`

Where `<path>` specifies an existing path for extracting the language pack installer.

!!! Note
    By default EDB Language Pack is installed in `C:\edb\languagepack\v1`.

If you're upgrading the PEM Server using StackBuilder Plus, then you might see an error. After displaying the error, PEM reports that installation is completed. However, the installation isn't complete. You need to do the installation by invoking the installer file from the location where it is downloaded.

After upgrading the PEM server, you might want to upgrade the backend database to a more recent version. For information, see [Upgrading the backend Postgres database](../upgrading_backend_database/).