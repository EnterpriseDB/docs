---
title: Functions 
navTitle: Functions
description: Reference for the functions provided by the PGAA extension.
---

The reference section is a list functions available with Analytics Accelerator.

Refer to [PGFS functions for Pipelines](/edb-postgres-ai/latest/ai-factory/pipeline/pgfs/functions) for details.

- SQL functions
  - Catalog functions
  - Table functions
  - Spark functions
  - Background task functions


## Table functions

### pgaa.list_tables

Lists all PGAA tables on the instance, their storage location, and path.

**Synopsis**

```sql
SELECT * FROM pgaa.list_analytics_tables();
```

**Parameters**

None.

**Returns**


| Parameter  | Type       | Description                              
| ---------- | ---------- | ---------------------------------------- 
| `schema_name`           | `TEXT` | The schema of the table.                                  
| `table_name`            | `TEXT` | The name of the table.                                    
| `managed_by`            | `TEXT` | The name of the Iceberg REST Catalog from which this table is synced (attached).
| `object_storage_snapshot_size_bytes`            | `BIGINT` | Size in bytes of the latest snapshot in object storage. 
| `object_storage_total_size_bytes`            | `BIGINT` | Size in bytes of all table data in object storage.
| `replication_status`            | `ENUM` | One of `disabled`, `initial_offload`, or `enabled`
| `storage_location_name`            | `TEXT` | Name of the `pgfs.storage_location` containing the table
| `storage_location_path`            | `TEXT` | Path within the storage location of the table
| `catalog_name`            | `TEXT` | Name of the Iceberg REST Catalog containing the table (origin or replication target)
| `catalog_namespace`            | `TEXT` | The namespace (i.e., schema) of the table in the Iceberg REST Catalog
| `catalog_table`            | `TEXT` | The name of the table in the Iceberg REST Catalog


A table can either have a storage location or a catalog. It cannot have both. 

The catalog details refer to either the replication target, if performing a catalog-managed offload or replication to object storage, or to the source catalog location, if reading data from tables managed by an external catalog.
See [Metadata management](/pgaa/current/tiered_tables/#other-operations) for details.

### pgaa.lakehouse_table_stats

Returns the size in bytes of the latest version of a Lakehouse table and the total size of all versions.

**Synopsis**

```sql
SELECT * FROM pgaa.lakehouse_table_stats();
```

**Parameters**

| Parameter  | Type       | Description                              
| ---------- | ---------- | ---------------------------------------- 
| `relation` | `REGCLASS` | The name of the table to get the size of. 

**Returns**

| Column                 | Type     | Description                                           
| ---------------------- | -------- | ----------------------------------------------------- 
| `latest_snapshot_size` | `BIGINT` | The size in bytes of the latest snapshot of the table.
| `total_size`           | `BIGINT` | The total size in bytes of all versions of the table.  



## Catalog functions

### pgaa.add_catalog

Registers a new external catalog service (like an Iceberg REST Catalog) within your Postgres instance.

**Synopsis**

```sql
SELECT pgaa.add_catalog(
    catalog_name TEXT,
    catalog_type TEXT,
    catalog_options JSON
);
```

**Parameters**

| Column                 | Type     | Description                                           
| ---------------------- | -------- | ----------------------------------------------------- 
| `catalog_name` | `TEXT` | The unique name to assign to the external catalog configuration.
| `catalog_type` | `TEXT` | The type of catalog service. Supported options are `iceberg-rest` (Iceberg REST catalog), and `iceberg-s3tables` (AWS S3 Tables).
| `catalog_options` | `JSON` | A JSON object containing the catalog service options.

Depending on which storage you use, your JSON file for the `catalog_options` must specify different options.

- For REST catalogs

    ```json
    {
    "url": "https://your-catalog-endpoint.com",
    "warehouse_name": "your_warehouse_name",
    "warehouse": "your_warehouse_id",
    "token": "your_secret_auth_token"
    "danger_accept_invalid_certs": "false"
    }
    ```

    Where:

    - `url`: The base HTTP(S) endpoint of the REST catalog service.
    - `warehouse_name`: A human-readable alternative to the warehouse ID, supported by some REST providers for easier configuration.
    - `warehouse`: The unique identifier for the specific warehouse within the catalog service.
    - `danger_accept_invalid_certs`: If set to `true`, Postgres skips SSL certificate validation. Use this only for internal testing or with self-signed certificates; never use it for sensitive public connections.

    Some Iceberg REST Catalog providers, like Snowflake Open Catalog, might expect different parameters. Specify the following OAuth options:

    ```json
    {
    "oauth2.grant_type": "client_credentials",
    "oauth2.client_id": "oauth-client-id",
    "oauth2.client_secret": "oauth-client-secret",
    "oauth2.token_uri": "https://EXAMPLE-polaristest.snowflakecomputing.com/polaris/api/catalog/v1/oauth/tokens",
    "oauth2.scope": "PRINCIPAL_ROLE:read_only"
    }
    ```

    Where:

    - `oauth2.grant_type`: Specifies the OAuth2 flow. The most common value for service-to-service communication is `client_credentials`.
    - `oauth2.client_id`: The unique identifier for your application registered with the identity provider.
    - `oauth2.client_secret`: The secret key used to authenticate the client ID.
    - `oauth2.token_uri`: The full HTTP(S) endpoint where PGAA sends the credentials to request an access token.
    - `oauth2.scope`: (Optional) A space-delimited list of permissions or resources the client is requesting access to.


- For AWS S3 Tables: 

    ```json
    {
    "arn": "arn:aws:s3tables:us-east-1:1234567890:bucket/my-bucket",
    "region": "us-east-1"
    }
    ```

    Where:

    - `arn`: Specifies the Amazon Resource Name (ARN), the unique identifier for your S3 Table bucket.
    - `region`: Specifies the physical AWS data center location where your S3 Table bucket resides.

**Returns**

None.

### pgaa.attach_catalog

Makes an already registered external catalog (using `pgaa.add_catalog`) available for querying within the current PostgreSQL session.

**Synopsis**

```sql
SELECT pgaa.attach_catalog(
    catalog_name TEXT
);
```

**Parameters**

| Column                 | Type     | Description                                           
| ---------------------- | -------- | ----------------------------------------------------- 
| `catalog_name` | `TEXT` | The unique name of the external catalog that was previously registered by `pgaa.add_catalog`.

**Returns**

None.


Add:
- `pgaa.update_catalog()`: Updates and validates catalog options for an existing catalog.
- `pgaa.delete_catalog()`: Deletes a catalog from the database.
- `pgaa.list_catalogs()`: Returns detailed information about all registered catalogs.
- `pgaa.list_catalog_tables()`: Lists all tables in a catalog, allowing you to explore its contents and testing connectivity without importing or attaching tables.
- `pgaa.test_catalog()`: Tests connectivity to a catalog.



         List of functions
 Schema |        Name         |             Result data type             |                      Argument data types                      | Type | Volatility | Parallel |  Owner   | Security | Access privileges | Language | Internal name |                                                                                                                     Description                                                                                                                      
--------+---------------------+------------------------------------------+---------------------------------------------------------------+------+------------+----------+----------+----------+-------------------+----------+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 pgaa   | drop_catalog_tables | TABLE(schema_name text, table_name text) | catalog_name character varying, cascade boolean DEFAULT false | func | volatile   | unsafe   | postgres | invoker  |                   | plpgsql  |               | Drop all PGAA tables that are managed by the specified catalog. This function will drop the local PGAA tables and views managed by the catalog, including any dependent objects if cascade is true. It does not affect tables in the catalog itself.
(1 row)


## Spark functions

### pgaa.execute_compaction

Performs compaction to improve the performance and storage efficiency of a PGAA table.

**Synopsis**

```sql
CALL pgaa.execute_compaction(`relation_name`);
```

**Parameters**

| Column                 | Type     | Description                                           
| ---------------------- | -------- | ----------------------------------------------------- 
| `relation` | `REGCLASS` | The name of the PGAA table.

**Returns**

None.