---
navTitle: PGD CLI
navigation:
  - index
  - release-notes
  - pgd
  - pgd_check-health
  - pgd_show-camo
  - pgd_show-clockskew
  - pgd_show-events
  - pgd_show-nodes
  - pgd_show-raft
  - pgd_show-replslots
  - pgd_show-subscriptions
  - pgd_show-version
title: PGD CLI
directoryDefaults:
  description: >-
    The PGD Command Line Interface (CLI) is a tool to manage your BDR cluster
---

The PGD Command Line Interface (CLI) is a tool to manage your BDR cluster. PGD stands for 'EDB Postgres Distributed'. It allows you to run commands against BDR clusters. You can use it to inspect and manage cluster resources, and view membership events, worker errors etc.

There are commands available to get following details -

-   node summary
-   BDR/Postgres version on each node
-   replication and subscription details
-   membership and worker events
-   raft consensus details
-   CAMO (Commit at Most Once) details
-   clock skew
-   cluster health summary etc.

## Supported version

BDR 4.1 and above

## Supported commands

Following commands are available today -

```sh
pgd check-health
pgd show-camo
pgd show-clockskew
pgd show-events
pgd show-nodes
pgd show-raft
pgd show-replslots
pgd show-subscriptions
pgd show-version
```

Documentation for each command is located at [pgd](./pgd.md)

You can get help on the command line to see the supported commands,

```sh
pgd help
```

The help for a command and the parameters,

```sh
pgd help show-nodes
```

## Configuration

For configuration, by default, `pgd` looks for a file named `pgd-config.yml` in the `/etc/edb` directory. The YAML config file should have the database connection string of at least one BDR node in the cluster.

Sample `pgd-config.yml` is given below -

```yaml
cluster:
  name: cluster-name
  endpoints:
  - "host=bdr-a1 port=5432 dbname=bdrdb user=postgres "
  - "host=bdr-b1 port=5432 dbname=bdrdb user=postgres "
  - "host=bdr-c1 port=5432 dbname=bdrdb user=postgres "
```

Cluster name is currently optional and not validated.

You can customize config file name or path using following options.

`-f (or --config-file)` flag is optional but if provided it will be used as a config file.

```sh
  pgd show-nodes -f /opt/my-config.yml
```

If `-f (or --config-file)` flag is not provided then by default `pgd-config.yml` is searched at following locations (precedence order - higher to lower).

  1. "/etc/edb" (default)
  2. "$HOME/.edb"
  3. "." (working directory)

```sh
  pgd show-nodes
```

### --dsn flag

Using the `--dsn` flag you can directly pass a database connection string to command. You don't need a config file in that case. This flag takes precedence over config file even if it is present.

```sh
pgd show-nodes --dsn "host=bdr-a1 port=5432 dbname=bdrdb user=postgres "
```

## Postgres user privileges

Currently, pgd cli requires postgres superuser privileges to run.

## Installation

### TPAexec

The easiest way to install and configure `pgd` is to use EDB's TPAexec utility for cluster deployment and management. For details on this software, see the [TPAexec product page](https://access.2ndquadrant.com/customer_portal/sw/tpa/).

TPAexec by default install pgd cli package ('edb-pgd-cli') on each BDR node. It also auto creates the config file (`/etc/edb/pgd-config.yml`) prepopulated with the endpoints of each node in the cluster.
If you wish to install it on any non-bdr instance in the cluster then you can attach `pgdcli` role to that instance in TPAexec's config file.

### Manual

You can install this cli tool on any Linux machine. EDB provides the `.deb` and `.rpm` packages for it. The name of the package is `edb-pgd-cli`.

Once the [BDR repository](https://techsupport.enterprisedb.com/software_subscriptions/add/products/bdr4/) is setup you should be able to install cli package.

```sh
# for debian
sudo apt-get install edb-pgd-cli
```

This tool uses the Golang Postgres driver to connect to BDR nodes. Therefore, the database connectivity between cli node and BDR nodes should be present and working. The exact steps required for this configuration are highly dependent on the way your BDR cluster is configured and from where you are running cli; hence, it is outside the scope of this document.

## Output format

By default cli outputs in tabular format. However, it also supports `json` and `yaml` output format.

```sh
pgd show-nodes -o json
```

The one advantage of using these output formats over tabular format is for some commands you get to see extra fields which are not possible to display in tabular format due to space crunch on terminal.

!!! Note
    Support for `yaml` format is experimental and may not be fully supported in future versions. Also, unlike json, yaml output has fields in alphabetical order. It doesn't preserve the field order.
