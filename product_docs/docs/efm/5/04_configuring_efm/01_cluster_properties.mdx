---
title: "The cluster properties file"
redirects:
 - ../../efm_user/04_configuring_efm/01_cluster_properties
legacyRedirectsGenerated:
  # This list is generated by a script. If you need add entries, use the `legacyRedirects` key.
  - "/edb-docs/d/edb-postgres-failover-manager/user-guides/user-guide/4.0/cluster_properties.html"
  - "/edb-docs/d/edb-postgres-failover-manager/user-guides/user-guide/4.1/cluster_properties.html"
---

<div id="cluster_properties" class="registered_link"></div>

Each node in a Failover Manager cluster has a properties file (by default, named `efm.properties`) that contains the properties of the individual node on which it resides. The Failover Manager installer creates a file template for the properties file named `efm.properties.in` in the `/etc/edb/efm-5.<x>` directory.

After completing the Failover Manager installation, make a working copy of the template before modifying the file contents:

```text
# cp /etc/edb/efm-5.2/efm.properties.in /etc/edb/efm-5.2/efm.properties
```

After copying the template file, change the owner of the file to efm:

```text
# chown efm:efm efm.properties
```

!!! Note
    By default, Failover Manager expects the cluster properties file to be named `efm.properties`. If you name the properties file something other than `efm.properties`, modify the service script or unit file to instruct Failover Manager to use a different name.

After creating the cluster properties file, add or modify configuration parameter values as required. For detailed information about each property, see [Specifying cluster properties](#specifying-cluster-properties).

The Failover Manager service script expects to find the files in the `/etc/edb/efm-5.<x>` directory. If you move the property file to another location, you must create a symbolic link that specifies the new location.

!!! Note
    All user scripts referenced in the properties file are invoked as the Failover Manager user.

<div id="specifying_cluster_properties" class="registered_link"></div>

## Specifying cluster properties

You can use the properties listed in the cluster properties file to specify connection properties and behaviors for your Failover Manager cluster. Modifications to property settings are applied when Failover Manager starts. If you modify a property value, you must restart Failover Manager to apply the changes.

Property values are case sensitive. While Postgres uses quoted strings in parameter values, Failover Manager doesn't allow quoted strings in property values. For example, while you might specify an IP address in a Postgres configuration parameter as:

`listen_addresses='192.168.2.47'`

With Failover Manager, don't enclose the value in quotes:

`bind.address=192.168.2.54:7800`

Use the properties in the `efm.properties` file to specify connection, administrative, and operational details for Failover Manager.

**Legends:** In the following table:

-   `A`: Required on primary or standby node
-   `W`: Required on witness node
-   `S`: Must be the same on all nodes
-   `Y`: Yes

| **Property name**                                             | **A** | **W** | **S** | **Default value**                     | **Comments**                                                                                                                                                   |
| ------------------------------------------------------------- | ----- | ----- | ----- | ------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [db.user](#db_user)                                           | Y     | Y     |       |                                       | Username for the database.                                                                                                                                      |
| [db.password.encrypted](#db_password_encrypted)               | Y     | Y     |       |                                       | Password encrypted using 'efm encrypt'.                                                                                                                         |
| [db.port](#db_port)                                           | Y     | Y     | Y     |                                       |                                                                                                                                                                 |
| [db.database](#db_database)                                   | Y     | Y     |       |                                       | Database name.                                                                                                                                                  |
| [db.service.owner](#db_service_owner)                         | Y     |       |       |                                       | Owner of $PGDATA dir for db.database.                                                                                                                         |
| [db.service.name](#db_service_name)                           |       |       |       |                                       | Required if running the database as a service.                                                                                                                  |
| [db.bin](#db_bin)                                             | Y     |       |       |                                       | Directory containing the pg_controldata/pg_ctl commands such as '/usr/edb/as*nn*/bin'.                                                                            |
| [db.data.dir](#db_data_dir)                                   | Y     |       |       |                                       | Same as the output of query 'show data_directory;'                                                                                                             |
| [db.config.dir](#db_config_dir)                               |       |       |       |                                       | Same as the output of query 'show config_file;'. Specify if it's not the same as *db.data.dir*.                                                        |
| [jdbc.sslmode](#jdbc_sslmode)                                 | Y     | Y     |       | disable                               | See the [note](#jdbc_note).                                                                                                                                     |
| [user.email](#user_email)                                     |       |       | Y     |                                       | This value can be left blank if using a notification script.                                                                  |
| [from.email](#from_email).                                    |       |       |       | [efm@localhost](mailto:efm@localhost) | Leave blank to use the default [efm@localhost](mailto:efm@localhost).                                                                                           |
| [notification.level](#notification_level)                     | Y     | Y     |       | INFO                                  | See the [list of notifications](../10_notifications/#notifications).                                                                                         |
| [notification.text.prefix](#notification_text_prefix)         |       |       |       |                                       |                                                                                                                                                                |
| [script.notification](#script_notification)                   |       |       |       |                                       | Required if user.email property is not used; both parameters can be used together.                                                                              |
| [bind.address](#bind_address)                                 | Y     | Y     |       |                                       | Example: &lt;ip_address>:&lt;port>                                                                                                                             |
| [external.address](#external_address)                         |       |       |       |                                       | Example: &lt;ip_address/hostname>                                                                                                                              |
| [admin.port](#admin_port)                                     | Y     | Y     |       | 7809                                  | Modify if the default port is already in use.                                                                                                                   |
| [is.witness](#is_witness)                                     | Y     | Y     |       |                                       | See description.                                                                                                                                                |
| [local.period](#local_period)                                 | Y     |       |       | 10                                    |                                                                                                                                                                |
| [local.timeout](#local_timeout)                               | Y     |       |       | 60                                    |                                                                                                                                                                |
| [local.timeout.final](#local_timeout_final)                   | Y     |       |       | 10                                    |                                                                                                                                                                |
| [remote.timeout](#remote_timeout)                             | Y     | Y     |       | 10                                    |                                                                                                                                                                |
| [node.timeout](#node_timeout)                                 | Y     | Y     | Y     | 50                                    |                                                                                                                      |
| [encrypt.agent.messages](#encrypt_agent_messages)             | Y     | Y     | Y     | false                                 |                                                                                                                      |
| [enable.stop.cluster](#enable_stop_cluster)                   |       |       | Y     | true                                  |                                                                                                                      |
| [stop.isolated.primary](#stop_isolated_primary)               | Y     |       |       | true                                  |                                                                                                                                                                                                                                         |
| [stop.failed.primary](#stop_failed_primary)                   | Y     |       |       | true                                  |                                                                                                                                                                |
| [primary.shutdown.as.failure](#primary_shutdown_as_failure)   | Y     | Y     | Y     | false                                 |                                                                                                                                                                |
| [update.physical.slots.period](#update_physical_slots_period) | Y     |       |       | 0                                     |                                                                                                                                                                |
| [ping.server.ip](#ping_server_ip)                             | Y     | Y     |       | 8.8.8.8                               |                                                                                                                                                                |
| [ping.server.command](#ping_server_command)                   | Y     | Y     |       | /bin/ping -q -c3 -w5                  |                                                                                                                                                                |
| [auto.allow.hosts](#auto_allow_hosts)                         | Y     | Y     |       | false                                 |                                                                                                                                                                |
| [stable.nodes.file](#stable_nodes_file)                       | Y     | Y     |       | false                                 |                                                                                                                                                                |
| [db.reuse.connection.count](#db_reuse_connection_count)       | Y     |       |       | 0                                     |                                                                                                                                                                |
| [auto.failover](#auto_failover)                               | Y     | Y     | Y     | true                                  |                                                                                                                                                                |
| [auto.reconfigure](#auto_reconfigure)                         | Y     |       |       | true                                  |                                                                                                                                                                                               |
| [auto.rewind](#auto_rewind)                                   | Y     |       |       | false                                 |                                                                                                                                                                |
| [auto.basebackup](#auto_basebackup)                           | Y     |       |       | false                                 |                                                                                                                                                                |
| [promotable](#promotable)                                     | Y     |       |       | true                                  |                                                                                                                                                                |
| [use.replay.tiebreaker](#use_replay_tiebreaker)               | Y     | Y     | Y     | true                                  |                                                                                                                                                                                               |
| [standby.restart.delay](#standby_restart_delay)               |       |       |       | 0                                     |                                                                                                                                                                |
| [application.name](#application_name)                         |       |       |       |                                       | Set to replace the application_name portion of the primary_conninfo entry with this property value before starting the original primary database as a standby. |
| [restore.command](#restore_command)                           |       |       |       |                                       | Example: restore.command=scp &lt;db_service_owner>@%h: &lt;archive_path>/%f %p                                                                                 |
| [backup.wal](#backup_wal)                                     |       |       |       | false                                 |                                                                                                                                                                |
| [reconfigure.num.sync](#reconfigure_num_sync)                 | Y     |       |       | false                                 |               If you are on Failover Manager 4.1, see reconfigure_num_sync_max to raise num_sync. |                                                                                                                                                 |
| [reconfigure.num.sync.max](#reconfigure_num_sync_max)         |       |       |       |                                       |                      |
| [reconfigure.sync.primary](#reconfigure_sync_primary)         | Y     |       |       | false                                 |                                                                                                                                                                |
| [check.num.sync.period](#check_num_sync_period)               | Y     |       |       | 30                                    |                                                                                                                                                                |
| [minimum.standbys](#minimum_standbys)                         | Y     | Y     | Y     | 0                                     |                                                                                                                       |
| [priority.standbys](#priority_standbys)                       |       |       |       |                                       |    |                                                                                                                                                                |
| [recovery.check.period](#recovery_check_period)               | Y     |       |       | 1                                     |                                                                                                                                                                |
| [restart.connection.timeout](#restart_connection_timeout)     |       |       |       | 60                                    |                                                                                                                                                                |
| [auto.resume.startup.period](#auto_resume_startup_period)     | Y     |       |       | 0                                     |                                                                                                                                                                |
| [auto.resume.failure.period](#auto_resume_failure_period)     | Y     |       |       | 0                                     |                                                                                                                                                                |
| [virtual.ip](#virtual_ip)                                     |       |       | *     | (see virtual.ip.single)               | Leave blank if you do not specify a VIP.                                                                                                                        |
| [virtual.ip.interface](#virtual_ip)                           |       |       |       |                                       | Required if you specify a VIP.                                                                                                                                  |
| [virtual.ip.prefix](#virtual_ip)                              |       |       |       |                                       | Required if you specify a VIP.                                                                                                                                  |
| [virtual.ip.single](#virtual_ip)                              | Y     | Y     | Y     | Yes                                   |                                                                                                                       |
| [check.vip.before.promotion](#check_vip_before_promotion)     | Y     | Y     | Y     | Yes                                   |                                                                                                                                                                 |
| [check.vip.timeout](#check_vip_timeout)                       | Y     | Y     |       | 60                                    |                                                                                                                                                                 |
| [release.vip.background](#release_vip_background)             |       |       |       | true                                  | Required if you specify a VIP.                                                                                                                                  |
| [release.vip.pre.wait](#release_vip_background)               |       |       |       | 0                                     | Required if you specify a VIP.                                                                                                                                  |
| [release.vip.post.wait](#release_vip_background)              |       |       |       | 0                                     | Required if you specify a VIP.                                                                                                                                  |
| [pgpool.enable](#pgpool_enable)                               |       |       |       | false                                 |                                                                                                                                                             |
| [pcp.user](#pgpool_enable)                                    |       |       |       |                                       | Required if pgpool.enable is set to true.                                                                                                                       |
| [pcp.host](#pgpool_enable)                                    |       |       |       |                                       | Required if pgpool.enable is set to true, this value must be same for all the agents.                                                                           |
| [pcp.port](#pgpool_enable)                                    |       |       |       |                                       | Required if pgpool.enable is set to true, this value must be same for all the agents.                                                                           |
| [pcp.pass.file](#pgpool_enable)                               |       |       |       |                                       | Required if pgpool.enable is set to true.                                                                                                                        |
| [pgpool.bin](#pgpool_enable)                                  |       |       |       |                                       | Required if pgpool.enable is set to true.                                                                                                                      |
| [script.load.balancer.attach](#script_load_balancer)          |       |       |       |                                       | Example: script.load.balancer.attach= /&lt;path>/&lt;attach_script> %h %t                                                                                      |
| [script.load.balancer.detach](#script_load_balancer)          |       |       |       |                                       | Example: script.load.balancer.detach= /&lt;path>/&lt;detach_script> %h %t                                                                                      |
| [detach.on.agent.failure](#detach_on_agent_failure)           |       |       | Y     | false                                 | We recommend not to change the default in Failover Manager versions 5.0 and later.  |
| [script.fence](#script_fence)                                 |       |       |       |                                       | Example: script.fence= /&lt;path>/&lt;script_name> %p %f                                                                                                       |
| [script.post.promotion](#script_post_promotion)               |       |       |       |                                       | Example: script.post.promotion= /&lt;path>/&lt;script_name> %f %p                                                                                              |
| [script.resumed](#script_resumed)                             |       |       |       |                                       | Example: script.resumed= /&lt;path>/&lt;script_name>                                                                                                           |
| [script.db.failure](#script_db_failure)                       |       |       |       |                                       | Example: script.db.failure= /&lt;path>/&lt;script_name>                                                                                                        |
| [script.primary.isolated](#script_primary_isolated)           |       |       |       |                                       | Example: script.primary.isolated= /&lt;path>/&lt;script_name>                                                                                                  |
| [script.remote.pre.promotion](#script_remote_pre_promotion)   |       |       |       |                                       | Example: script.remote.pre.promotion= /&lt;path>/&lt;script_name> %p                                                                                           |
| [script.remote.post.promotion](#script_remote_post_promotion) |       |       |       |                                       | Example: script.remote.post.promotion= /&lt;path>/&lt;script_name> %p                                                                                          |
| [script.custom.monitor](#script_custom_monitor)               |       |       |       |                                       | Example: script.custom.monitor= /&lt;path>/&lt;script_name>                                                                                                    |
| [custom.monitor.interval](#script_custom_monitor)             |       |       |       |                                       | Required if a custom monitoring script is specified.                                                                                                            |
| [custom.monitor.timeout](#script_custom_monitor)              |       |       |       |                                       | Required if a custom monitoring script is specified.                                                                                                            |
| [custom.monitor.safe.mode](#script_custom_monitor)            |       |       |       |                                       | Required if a custom monitoring script is specified.                                                                                                            |
| [sudo.command](#sudo_command)                                 | Y     | Y     |       | sudo                                  |                                                                                                                                                                |
| [sudo.user.command](#sudo_command)                            | Y     | Y     |       | sudo -u %u                            |                                                                                                                                                                |
| [lock.dir](#lock_dir)                                         |       |       |       |                                       | If not specified, defaults to '/var/lock/efm-&lt;version>'                                                                                                     |
| [log.dir](#log_dir)                                           |       |       |       |                                       | If not specified, defaults to '/var/log/efm-&lt;version>'                                                                                                      |
| [syslog.host](#syslog_logging)                                |       |       |       | localhost                             |                                                                                                                                                                |
| [syslog.port](#syslog_logging)                                |       |       |       | 514                                   |                                                                                                                                                                |
| [syslog.protocol](#syslog_logging)                            |       |       |       | UDP                                   |                                                                                                                                                                |
| [syslog.facility](#syslog_logging)                            |       |       |       | LOCAL1                                |                                                                                                                                                                |
| [file.log.enabled](#logtype_enabled)                          | Y     | Y     |       | true                                  |                                                                                                                                                                |
| [syslog.enabled](#logtype_enabled)                            | Y     | Y     |       | false                                 |                                                                                                                                                                |
| [jgroups.loglevel](#loglevel)                                 |       |       |       | info                                  |                                                                                                                                                                |
| [efm.loglevel](#loglevel)                                     |       |       |       | info                                  |                                                                                                                                                                |
| [jdbc.loglevel](#loglevel)                                    |       |       |       | info                                  |                                                                                                                                                                |
| [jvm.options](#jvm_options)                                   |       |       |       | -Xmx128m                              |                                                                                                                                                                |

## Cluster properties

<div id="db_user" class="registered_link"></div>

<div id="db_password_encrypted" class="registered_link"></div>

<div id="db_port" class="registered_link"></div>

<div id="db_database" class="registered_link"></div>

Use the following properties to specify connection details for the Failover Manager cluster:

```ini
# The value for the password property should be the output from
# 'efm encrypt' -- do not include a cleartext password here. To
# prevent accidental sharing of passwords among clusters, the
# cluster name is incorporated into the encrypted password. If
# you change the cluster name (the name of this file), you must
# encrypt the password again with the new name.
# The db.port property must be the same for all nodes.
db.user=
db.password.encrypted=
db.port=
db.database=
```

The `db.user` specified must have enough privileges to invoke selected PostgreSQL commands on behalf of Failover Manager. For more information, see [Prerequisites](../installing/prerequisites/#prerequisites).

For information about encrypting the password for the database user, see [Encrypting your database password](02_encrypting_database_password/#encrypting_database_password).

<div id="db_service_owner" class="registered_link"></div>

Use the `db.service.owner` property to specify the name of the operating system user that owns the cluster that is being managed by Failover Manager. This property isn't required on a dedicated witness node.

```ini
# This property tells EFM which OS user owns the $PGDATA dir for
# the 'db.database'. By default, the owner is either 'postgres'
# for PostgreSQL or 'enterprisedb' for EDB Postgres Advanced
# Server. However, if you have configured your db to run as a
# different user, you will need to copy the /etc/sudoers.d/efm-XX
# conf file to grant the necessary permissions to your db owner.
#
# This username must have write permission to the
# 'db.data.dir' specified below.
db.service.owner=
```

<div id="db_service_name" class="registered_link"></div>

Specify the name of the database service in the `db.service.name` property if you use the `service` or `systemctl` command when starting or stopping the service.

```ini
# Specify the proper service name in order to use service commands
# rather than pg_ctl to start/stop/restart a database. For example, if
# this property is set, then 'service <name> restart' or 'systemctl
# restart <name>'
# (depending on OS version) will be used to restart the database rather
# than pg_ctl.
# This property is required if running the database as a service.
db.service.name=
```

<div id="db_bin" class="registered_link"></div>

Use the same service control mechanism (`pg_ctl`, `service`, or `systemctl`) each time you start or stop the database service. If you use the `pg_ctl` program to control the service, specify the location of the `pg_ctl` program in the `db.bin` property.

```ini
# Specify the directory containing the pg_controldata/pg_ctl commands,
# for example:
# /usr/edb/as12/bin. Unless the db.service.name property is used, the
# pg_ctl command is used to start/stop/restart databases as needed
# after a failover or switchover. This property is required.
db.bin=
```

<div id="db_data_dir" class="registered_link"></div>

Use the `db.data.dir` property to specify the location where a `standby.signal` or `recovery.conf` file will be created. This property is required on primary and standby nodes. It isn't required on a dedicated witness node.

```ini
# This is the directory where a standby.signal file will exist for a standby node.
# If a primary database fails, a recovery.conf file will be written in this
# location to ensure that the failed database can not be restarted as the
# primary database.
# This corresponds to database environment variable PGDATA and should be same
# as the output of query 'show data_directory;' on respective database.
db.data.dir=
```

<div id="db_config_dir" class="registered_link"></div>

Use the `db.config.dir` property to specify the location of database configuration files if they aren't stored in the same directory as the `recovery.conf` or `standby.signal` file. This is the value specified by the `config_file` parameter directory of your EDB Postgres Advanced Server or PostgreSQL installation. This value is used as the location of the EDB Postgres Advanced Server `data` directory when stopping, starting, or restarting the database.

```ini
# Specify the location of database configuration files if they are
# not contained in the same location as the standby.signal
# file. This is most likely the case for Debian installations. The location
# specified will be used as the -D value (the location of the data directory
# for the cluster) when calling pg_ctl to start or stop the database.
# If this property is blank, the db.data.dir location specified by the
# db.data.dir property will be used.
# This corresponds to the output of query 'show config_file;' on respective database.
db.config.dir=
```

For more information about database configuration files, visit the [PostgreSQL website](https://www.postgresql.org/docs/current/runtime-config-file-locations.html).

<div id="jdbc_sslmode" class="registered_link"></div>

Use the `jdbc.sslmode` property to instruct Failover Manager to use SSL connections. By default, SSL is disabled.

```ini
# Use the jdbc.sslmode property to enable ssl for EFM
# connections. Setting this property to anything but 'disable'
# will force the agents to use 'ssl=true' for all JDBC database
# connections (to both local and remote databases).
# Valid values are:
#
# disable - Do not use ssl for connections.
# verify-ca - EFM will perform CA verification before allowing
# the certificate.
# require - Verification will not be performed on the server
# certificate.
jdbc.sslmode=disable
```

<div id="jdbc_note" class="registered_link"></div>

!!! Note
    If you set the value of `jdbc.sslmode` to `verify-ca` and you want to use Java trust store for certificate validation, you need to set the following value. This line can be added anywhere in the cluster properties file:

    `jdbc.properties=sslfactory=org.postgresql.ssl.DefaultJavaSSLFactory`

For information about configuring and using SSL, see [Secure TCP/IP Connections with SSL](https://www.postgresql.org/docs/current/static/ssl-tcp.html) and [Using SSL](https://jdbc.postgresql.org/documentation/head/ssl.html) in the PostgreSQL documentation.

<div id="user_email" class="registered_link"></div>

Use the `user.email` property to specify an email address (or multiple email addresses) to receive notifications sent by Failover Manager.

```ini
# Email address(es) for notifications. The value of this property must
# be the same across all agents. Multiple email addresses must
# be separated by space. This is required if not using a 'script.notification'
# script. Either/both can be used.
user.email=
```

<div id="from_email" class="registered_link"></div>

The `from.email` property specifies the value to use as the sender's address for email notifications from Failover Manager. You can:

-   Leave `from.email` blank to use the default value (`efm@localhost`).
-   Specify a custom value for the email address.
-   Specify a custom email address, using the `%h` placeholder to represent the name of the node host (for example, [example@%h](mailto:example@%h)). The placeholder is replaced with the name of the host as returned by the Linux hostname utility.

For more information about notifications, see [Notifications](../10_notifications/#notifications).

```ini
# Use the from.email property to specify the from email address that
# will be used for email notifications. Use the %h placeholder to
# represent the name of the node host (e.g. example@%h). The
# placeholder will be replaced with the name of the host as returned
# by the hostname command.
# Leave blank to use the default, efm@localhost.
from.email=
```

<div id="notification_level" class="registered_link"></div>

Use the `notification.level` property to specify the minimum severity level at which Failover Manager sends user notifications or when a notification script is called. For a complete list of notifications, see [Notifications](../10_notifications/#notifications).

```ini
# Minimum severity level of notifications that will be sent by
# the agent. The minimum level also applies to the notification
# script (below). Valid values are INFO, WARNING, and SEVERE.
# A list of notifications is grouped by severity in the user's
# guide.
notification.level=INFO
```

<div id="notification_text_prefix" class="registered_link"></div>

Use the `notification.text.prefix` property to specify the text to add to the beginning of every notification.

```ini
# Text to add to the beginning of every notification. This could
# be used to help identify what the cluster is used for, the role
# of this node, etc. To use multiple lines, add a backslash \ to
# the end of a line of text. To include a newline use \n.
# Example:
# notification.text.prefix=Development cluster for Example dept.\n\
# Used by Dev and QA \
# See Example group for questions.
notification.text.prefix=
```

<div id="script_notification" class="registered_link"></div>

Use the `script.notification` property to specify the path to a user-supplied script that acts as a notification service. The script is passed a message subject and a message body. The script is invoked each time Failover Manager generates a user notification.

```ini
# Absolute path to script run for user notifications.
#
# This is an optional user-supplied script that can be used for
# notifications instead of email. This is required if not using
# email notifications. Either/both can be used. The script will
# be passed two parameters: the message subject and the message
# body.
script.notification=
```

<div id="bind_address" class="registered_link"></div>

The `bind.address` property specifies the IP address and port number of the agent on the current node of the Failover Manager cluster.

```ini
# This property specifies the ip address and port that jgroups
# will bind to on this node. The value is of the form
# <ip>:<port>.
# Note that the port specified here is used for communicating
# with other nodes, and is not the same as the admin.port below,
# used only to communicate with the local agent to send control
# signals.
# For example, <provide_your_ip_address_here>:7800
bind.address=
```

<div id="external_address" class="registered_link"></div>

Use the `external.address` property to specify the IP address or hostname to use for communication with all other Failover Manager agents in a NAT environment.

```ini
# This is the ip address/hostname to be used for communication with all
# other Failover Manager agents. All traffic towards this address
# should be routed by the network to the bind.address of the node.
# The value is in the ip/hostname format only. This address will be
# used in scenarios where nodes are on different networks and broadcast
# an IP address other than the bind.address to the external world.
external.address=
```

<div id="admin_port" class="registered_link"></div>

Use the `admin.port` property to specify a port on which Failover Manager listens for administrative commands.

```ini
# This property controls the port binding of the administration
# server which is used for some commands (ie cluster-status). The
# default is 7809; you can modify this value if the port is
# already in use.
admin.port=7809
```

<div id="is_witness" class="registered_link"></div>

Set the `is.witness` property to `true` to indicate that the current node is a witness node. If `is.witness` is `true`, the local agent doesn't check to see if a local database is running.

```ini
# Specifies whether or not this is a witness node. Witness nodes
# do not have local databases running.
is.witness=
```

The EDB Postgres Advanced Server `pg_is_in_recovery()` function is a Boolean function that reports the recovery state of a database. The function returns `true` if the database is in recovery or `false` if the database isn't in recovery. When an agent starts, it connects to the local database and invokes the `pg_is_in_recovery()` function.

- If the server responds true, the agent assumes the role of standby.
- If the server responds false, the agent assumes the role of primary.
- If there's no local database, the agent assumes an idle state.

!!! Note
    If `is.witness` is `true`, Failover Manager doesn't check the recovery state.

<div id="local_period" class="registered_link"></div>

<div id="local_timeout" class="registered_link"></div>

<div id="local_timeout_final" class="registered_link"></div>

The following properties apply to an agent's local database server:

-   The `local.period` property specifies the number of seconds between attempts to contact the database server.
-   The `local.timeout` property limits the amount of time (in seconds) an agent waits for a positive response from the database server before proceeding with failure checks.
-   The `local.timeout.final` property limits the amount of time (in seconds) an agent will wait during a last connection attempt after the previous checks have failed. If the final connection attempt fails, or the database doesn't respond within the specified time, the Failover Manager agent considers the database to be unreachable. If a connection is made, the agent sends a notification and resumes monitoring.

For example, with the default values:

1.  A check of the local database (`local.period`) happens every 10 seconds.
1.  If an attempt to contact the local database doesn't come back positive within 60 seconds (`local.timeout`), Failover Manager initiates a final connection attempt.
1.  If the final connection attempt fails, or a response isn't received within 10 seconds (`local.timeout.final`), Failover Manager moves to the next step of asking the rest of the cluster if the database is reachable.

These properties aren't required on a dedicated witness node.

```ini
# These properties apply to the connection(s) EFM uses to monitor
# the local database. Every 'local.period' seconds, a database
# check is made in a background thread. If the main monitoring
# thread does not see that any checks were successful in
# 'local.timeout' seconds, then the main thread makes a final
# check with a timeout value specified by the
# 'local.timeout.final' value. All values are in seconds.
# Whether EFM uses single or multiple connections for database
# checks is controlled by the 'db.reuse.connection.count'
# property.
local.period=10
local.timeout=60
local.timeout.final=10
```

If necessary, modify these values to suit your business model.

<div id="remote_timeout" class="registered_link"></div>

Use the `remote.timeout` property to limit how many seconds an agent waits for a response from a remote agent or database. Agents only send messages to each other during cluster events. Examples include:
-   An agent asking other agents if they can connect to its database after it has become unreachable locally.
-   A primary agent requesting recovery settings from a standby agent as part of a switchover.
-   Telling nodes to prepare to shut down when stopping the Failover Manager cluster.

```ini
# Timeout for a call to check if a remote database is responsive.
# For example, this is how long a standby would wait for a
# DB ping request from itself and the witness to the primary DB
# before performing failover.
remote.timeout=10
```

<div id="node_timeout" class="registered_link"></div>

Use the `node.timeout` property to specify the number of seconds for an agent to wait for a heartbeat from another node when determining if a node has failed.

```ini
# The total amount of time in seconds to wait before determining
# that a node has failed or been disconnected from this node.
#
# The value of this property must be the same across all agents.
node.timeout=50
```

!!!note Summary/comparison of timeout properties
   - The `local.*` properties are for failure detection of an agent's local database.
   - The `node.timeout` property is for failure detection of other nodes.
   - The `remote.timeout` property limits how long agents wait for responses from other agents.
!!!

<div id="encrypt_agent_messages" class="registered_link"></div>

Use the `encrypt.agent.messages` property to specify whether to encrypt the messages sent between agents.

```ini
# Set to true to encrypt messages that are sent between agents.
# This property must be the same on all agents or else the agents
# will not be able to connect.
encrypt.agent.messages=false
```

<div id="enable_stop_cluster" class="registered_link"></div>

Use the `enable.stop.cluster` property to enable or disable the `stop-cluster` command. The command is a convenience in some environments but can cause issues when unintentionally invoked. In Eager Failover mode, the command results in stopping EDB Postgres Advanced Server without failover.

```ini
# Whether or not the 'efm stop-cluster <cluster name>' command is enabled.
# Set to false to disable the command, in which case all Failover
# Manager agents must be stopped individually. Note that stopping each
# agent separately will change the .nodes files on remaining agents
# unless stable.nodes.file is also true. This property value must
# be the same on all agents if set. The default is true if not set.
enable.stop.cluster=true
```

<div id="stop_isolated_primary" class="registered_link"></div>

Use the `stop.isolated.primary` property to instruct Failover Manager to shut down the database if a primary agent detects that it's isolated. When `true` (the default), Failover Manager stops the database before invoking the script specified in the `script.primary.isolated` property.

```ini
# Shut down the database after a primary agent detects that it has
# been isolated from the majority of the efm cluster. If set to
# true, efm will stop the database before running the
# 'script.primary.isolated' script, if a script is specified.
stop.isolated.primary=true
```

<div id="stop_failed_primary" class="registered_link"></div>

Use the `stop.failed.primary` property to instruct Failover Manager to attempt to shut down a primary database if it can't reach the database. If `true`, Failover Manager runs the script specified in the `script.db.failure` property after attempting to shut down the database.

```ini
# Attempt to shut down a failed primary database after EFM can no
# longer connect to it. This can be used for added safety in the
# case a failover is caused by a failure of the network on the
# primary node.
# If specified, a 'script.db.failure' script is run after this attempt.
stop.failed.primary=true
```

<div id="primary_shutdown_as_failure" class="registered_link"></div>

Use the `primary.shutdown.as.failure` property to treat any shutdown of the Failover Manager agent on the primary node as a failure. If this property is set to `true` and the primary agent is shut down, the rest of the cluster treats the shutdown as a failure. This includes any proper shutdown of the agent such as a shutdown of the whole node. None of the timeout properties apply in this case: when the agent exits, the rest of the cluster is notified immediately. After the agent exits, the rest of the cluster performs [checks](../11_supported_scenarios/#primary_agent_exits) that happen in the case of a primary agent failure. The [checks](../11_supported_scenarios/#primary_agent_exits) include attempting to connect to the primary database, seeing if the VIP is reachable if used, and so on).

-   If the database is reached, a notification is sent informing you of the agent status.
-   If the database isn't reached, a failover occurs.

```ini
# Treat a primary agent shutdown as an agent failure. This can be set
# to true to treat a primary agent shutdown as a failure situation.
# Caution should be used when using this feature, as it could
# cause an unwanted promotion in the case of performing primary
# database maintenance.
# Please see the user's guide for more information.
primary.shutdown.as.failure=false
```

The `primary.shutdown.as.failure` property is meant to catch user error, rather than failures, such as the accidental shutdown of a primary node. The proper shutdown of a node can appear to the rest of the cluster as if a user has stopped the primary Failover Manager agent, for example to perform maintenance on the primary database. If you set the `primary.shutdown.as.failure` property to `true`, take care when performing maintenance.

To perform maintenance on the primary database when `primary.shutdown.as.failure` is `true`, stop the primary agent and wait to receive a notification that the primary agent has failed but the database is still running. Then, it is safe to stop the primary database. Alternatively, you can use the `stop-cluster` command to stop all of the agents without performing failure checks.

<div id="update_physical_slots_period" class="registered_link"></div>

Use the `update.physical.slots.period` property to define the slot advance frequency. When `update.physical.slots.period` is set to a positive integer value, the primary agent reads the current `restart_lsn` of the physical replication slots after every `update.physical.slots.period` seconds. It sends this information with its `pg_current_wal_lsn` and `primary_slot_name` (if it's set in the `postgresql.conf` file) to the standbys. The physical slots must already exist on the primary for the agent to find them. If physical slots don't already exist on the standbys, standby agents create the slots and then update the `restart_lsn` parameter for these slots. A non-promotable standby doesn't create new slots but updates them if they exist.

Before updating the `restart_lsn` value of a slot, the agent checks to see if an `xmin` value has been set, which may happen if this was previously a primary node. If an `xmin` value has been set for the slot, the agent drops and recreates the slot before updating the `restart_lsn` value.

Note: all slot names, including one set on the current primary if desired, must be unique.

```ini
# Period in seconds between having the primary agent update promotable
# standbys with physical replication slot information so that
# the cluster will continue to use replication slots after a failover.
# Set to zero to turn off.
update.physical.slots.period=0
```

<div id="ping_server_ip" class="registered_link"></div>

Use the `ping.server.ip` property to specify the IP address of a server that Failover Manager can use to confirm that network connectivity isn't a problem.

```ini
# This is the address of a well-known server that EFM can ping
# in an effort to determine network reachability issues. It
# might be the IP address of a nameserver within your corporate
# firewall or another server that *should* always be reachable
# via a 'ping' command from each of the EFM nodes.
#
# There are many reasons why this node might not be considered
# reachable: firewalls might be blocking the request, ICMP might
# be filtered out, etc.
#
# Do not use the IP address of any node in the EFM cluster
# (primary, standby, or witness) because this ping server is meant
# to provide an additional layer of information should the EFM
# nodes lose sight of each other.
#
# The installation default is Google's DNS server.
ping.server.ip=8.8.8.8
```

<div id="ping_server_command" class="registered_link"></div>

Use the `ping.server.command` property to specify the command used to test network connectivity.

```ini
# This command will be used to test the reachability of certain
# nodes.
#
# Do not include an IP address or hostname on the end of
# this command - it will be added dynamically at runtime with the
# values contained in 'virtual.ip' and 'ping.server.ip'.
#
# Make sure this command returns reasonably quickly - test it
# from a shell command line first to make sure it works properly.
ping.server.command=/bin/ping -q -c3 -w5
```

<div id="auto_allow_hosts" class="registered_link"></div>

Use the `auto.allow.hosts` property to instruct the server to use the addresses specified in the `.nodes` file of the first node to start to set the allowed host list. Enabling this property by setting `auto.allow.hosts` to `true` can simplify cluster startup.

```ini
# Have the first node started automatically add the addresses from
# its .nodes file to the allowed host list. This will make it
# faster to start the cluster when the initial set of hosts
# is already known.
auto.allow.hosts=false
```

<div id="stable_nodes_file" class="registered_link"></div>

Use the `stable.nodes.file` property to instruct the server not to rewrite the nodes file when a node joins or leaves the cluster. This property is most useful in clusters with IP addresses that don't change.

```ini
# When set to true, EFM will not rewrite the .nodes file whenever
# new nodes join or leave the cluster. This can help starting a
# cluster in the cases where it is expected for member addresses
# to be mostly static, and combined with 'auto.allow.hosts' makes
# startup easier when learning failover manager.
stable.nodes.file=false
```

<div id="db_reuse_connection_count" class="registered_link"></div>

The `db.reuse.connection.count` property allows the administrator to specify the number of times Failover Manager reuses the same database connection to check the database health. The default value is 0, indicating that Failover Manager creates a fresh connection each time. This property isn't required on a dedicated witness node.

```ini
# This property controls how many times a database connection is
# reused before creating a new one. If set to zero, a new
# connection will be created every time an agent pings its local
# database.
db.reuse.connection.count=0
```

<div id="auto_failover" class="registered_link"></div>

The `auto.failover` property enables automatic failover. By default, `auto.failover` is set to `true`.

```ini
# Whether or not failover will happen automatically when the primary
# fails. Set to false if you want to receive the failover notifications
# but not have EFM actually perform the failover steps.
# The value of this property must be the same across all agents.
auto.failover=true
```

<div id="auto_reconfigure" class="registered_link"></div>

Use the `auto.reconfigure` property to instruct Failover Manager to enable or disable automatic reconfiguration of remaining standby servers after the primary standby is promoted to primary. Set the property to `true` (the default) to enable automatic reconfiguration or `false` to disable automatic reconfiguration. This property isn't required on a dedicated witness node.

```ini
# After a standby is promoted, Failover Manager will attempt to
# update the remaining standbys to use the new primary. Failover
# Manager will change the host parameter of the primary_conninfo
# entry in postgresql.auto.conf and restart the database. The
# restart command is contained in either the efm_db_functions or
# efm_root_functions file; default when not running db as an os
# service is: "pg_ctl restart -m fast -w -t <timeout> -D <directory>"
# where the timeout is the local.timeout property value and the
# directory is specified by db.data.dir. To turn off
# automatic reconfiguration, set this property to false.
auto.reconfigure=true
```

!!! Note
    `primary_conninfo` is a space-delimited list of keyword=value pairs.

<div id="auto_rewind" class="registered_link"></div>
<div id="auto_basebackup" class="registered_link"></div>

When the `auto.rewind` and/or `auto.basebackup` property is set to `true`, the agent will attempt to reconfigure a failed or replaced primary database as a standby using `pg_rewind` or `pg_basebackup`. Some cases that apply:
-   A primary database failure: when the agents are notified to reconfigure for the new primary, the original primary agent will check to see if it should rebuild.
-   An isolated primary node: when the node is reconnected to the cluster, the primary agent will check to see if it has been replaced by a newer primary and if it should rebuild (or resume as the primary if there was not a promotion).
-   On startup: if the agent sees that there is already a primary database in the cluster, and the local database is not configured to be a standby, it will check to see if it should rebuild.

If the agent sees that it should rebuild, it will collect current database configuration settings and perform the following:
-   If `auto.rewind` is set to true, the agent will run `pg_rewind` with the `--dry-run` option to see if a rewind is needed, rewind if indicated, and reconfigure the database as a standby before resuming monitoring. If there is an error running `pg_rewind` and `auto.basebackup` is set to true, the agent will rebuild with `pg_basebackup`.
-   If `auto.rewind` is set to false and `auto.basebackup` is set to true, the agent will use `pg_basebackup` to attempt to rebuild the database and resume monitoring.

!!! Note
    Use this feature with caution, as it is intended for use cases where it is necessary to automatically bring the failed node back into the cluster, and where the cause of the failure is known and predictable. There may be conditions where EFM is unable to rebuild the failed primary, and manual intervention is still required.

```ini
# Set either or both of these properties to true to have this agent
# attempt to reconfigure a failed primary database as a standby after
# failover. If both properties are set to true, the agent will attempt
# to use pg_rewind first, and then pg_basebackup if the rewind fails.
# See the user's guide for more information.
auto.rewind=false
auto.basebackup=false
```
!!! Note
    Since auto.rewind uses pg_rewind internally, all prerequisites for [pg_rewind](https://www.postgresql.org/docs/current/app-pgrewind.html) should be fulfilled before setting up this parameter. This means, you may whether have to [set wal_log_hints](https://www.postgresql.org/docs/current/runtime-config-wal.html#GUC-WAL-LOG-HINTS) to `on` or enable  [data_checksums](https://www.postgresql.org/docs/current/checksums.html) manually.

<div id="promotable" class="registered_link"></div>

Use the `promotable` property to indicate not to promote a node. The `promotable` property is ignored when a primary agent starts. This simplifies switching back to the original primary after a switchover or failover. To override the setting, use the `efm set-priority` command at runtime. For more information about the `efm set-priority` command, see [Using the efm utility](../07_using_efm_utility/#using_efm_utility).

```ini
# A standby with this set to false will not be added to the
# failover priority list, and so will not be available for
# promotion. The property will be used whenever an agent starts
# as a standby or resumes as a standby after being idle. After
# startup/resume, the node can still be added or removed from the
# priority list with the 'efm set-priority' command. This
# property is required for all non-witness nodes.
promotable=true
```

<div id="use_replay_tiebreaker" class="registered_link"></div>

If the same amount of data was written to more than one standby node and a failover occurs, the `use.replay.tiebreaker` value determines how Failover Manager selects a replacement primary. Set the `use.replay.tiebreaker` property to `true` to instruct Failover Manager to failover to the node that will come out of recovery faster, as determined by the log sequence number. To ignore the log sequence number and promote a node based on user preference, set `use.replay.tiebreaker` to `false`.

```ini
# Use replay LSN value for tiebreaker when choosing a standby to
# promote before using failover priority. Set this property to true to
# consider replay location as more important than failover priority
# (as seen in cluster-status command) when choosing the "most ahead"
# standby to promote.
use.replay.tiebreaker=true
```

<div id="standby_restart_delay" class="registered_link"></div>

Use the `standby.restart.delay` property to specify the time in seconds for the standby to wait before it gets reconfigured (stoppstarts) to follow the new primary after a promotion.

```ini
# Time in seconds for this standby to delay restarting to follow the
# primary after a promotion. This can be used to have standbys restart
# at different times to increase availability. Caution should be used
# when using this feature, as a delayed standby will not be following
# the new primary and care must be taken that the new primary retains
# enough WAL for the standby to follow it.
# Please see the user's guide for more information.
standby.restart.delay=0
```

<div id="application_name" class="registered_link"></div>

You can use the `application.name` property to provide the name of an application to copy to the `primary_conninfo` parameter before restarting an old primary node as a standby.

```ini
# During a switchover, recovery settings are copied from a standby
# to the original primary. If the application.name property is set,
# Failover Manager will replace the application_name portion of the
# primary_conninfo entry with this property value before starting
# the original primary database as a standby. If this property is
# not set, Failover Manager will remove the parameter value
# from primary_conninfo.
application.name=
```

!!! Note
    Set the `application.name` property on the primary and any promotable standby. In the event of a failover/switchover, the primary node can potentially become a standby node again.

<div id="restore_command" class="registered_link"></div>

Use the `restore.command` property to instruct Failover Manager to update the `restore_command` value when a new primary is promoted. `%h` represents the address of the new primary. Failover Manager replaces `%h` with the address of the new primary. `%f` and `%p` are placeholders used by the server. If the property is left blank, Failover Manager doesn't update the `restore_command` values on the standbys after a promotion.

See the PostgreSQL documentation for more information about using a [restore_command](https://www.postgresql.org/docs/current/runtime-config-wal.html#RUNTIME-CONFIG-WAL-ARCHIVE-RECOVERY).

```ini
# If the restore_command on a standby restores directly from the
# primary node, use this property to have Failover Manager change
# the command when a new primary is promoted.
#
# Use the %h placeholder to represent the address of the new primary.
# During promotion it will be replaced with the address of the new
# primary.
#
# If not specified, failover manager will not change the
# restore_command value, if any, on standby nodes.
#
# Example:
# restore.command=scp <db service owner>@%h:/var/lib/edb/as12/data/archive/%f %p
restore.command=
```

<div id="backup_wal" class="registered_link"></div>

Use the `backup_wal` property to instruct Failover Manager to make a backup of local WAL on a standby during reconfiguration to follow a new primary.

```ini
# When a standby is reconfigured to follow a new primary, its local WAL
# is removed. Set this property to true to create a backup of the WAL first.
# This is generally not necessary; the property has been added to allow
# backwards compatibility with the behavior of versions of Failover Manager
# before version 5. If not specified defaults to false.
backup.wal=false
```

<div id="reconfigure_num_sync" class="registered_link"></div>

The database parameter `synchronous_standby_names` on the primary node specifies the names and count of the synchronous standby servers that confirm receipt of data to ensure that the primary nodes can accept write transactions. When the `reconfigure.num.sync` property is set to `true`, Failover Manager reduces the number of synchronous standby servers and reloads the configuration of the primary node to reflect the current value.

```ini
# Reduce num_sync when the number of synchronous standbys drops below
# the value required by the primary database. If set to true, Failover
# Manager will reduce the number of standbys needed in the primary's
# synchronous_standby_names property and reload the primary
# configuration. Failover Manager will not reduce the number below 1,
# taking the primary out of synchronous replication, unless the
# reconfigure.sync.primary property is also set to true.
# To raise num_sync, see the reconfigure.num.sync.max property below.
reconfigure.num.sync=false
```

<div id="reconfigure_num_sync_max" class="registered_link"></div>

Use the `reconfigure.num.sync.max` property to specify the maximum number to which num-sync can be raised when a standby is added to the cluster.

```ini
# If reconfigure.num.sync is set to true and this property is set,
# Failover Manager will check if num_sync can be raised when a standby
# is added to the cluster.
# Failover Manager will not raise the value above the maximum set here.
# If the primary database has been taken out of synchronous mode
# completely (see the reconfigure.sync.primary property), then Failover
# Manager will not reconfigure the primary database if standbys are
# added to the cluster.
reconfigure.num.sync.max=
```

<div id="reconfigure_sync_primary" class="registered_link"></div>

Set the `reconfigure.sync.primary` property to `true` to take the primary database out of synchronous replication mode if the number of standby nodes drops below the level required. Set `reconfigure.sync.primary` to `false` to send a notification if the standby count drops without interrupting synchronous replication.

```ini
# Take the primary database out of synchronous replication mode when
# needed. If set to true, Failover Manager will clear the
# synchronous_standby_names configuration parameter on the primary
# if the number of synchronous standbys drops below the required
# level for the primary to accept writes.
# If set to false, Failover Manager will detect the situation but
# will only send a notification if the standby count drops below the
# required level.
#
# CAUTION: TAKING THE PRIMARY DATABASE OUT OF SYNCHRONOUS MODE MEANS
# THERE MAY ONLY BE ONE COPY OF DATA. DO NOT MAKE THIS CHANGE UNLESS
# YOU ARE SURE THIS IS OK.
reconfigure.sync.primary=false
```

!!! Note

    For Failover Manager versions before 5.0: If you're using the `reconfigure.num.sync` or `reconfigure.sync.primary` property, ensure that the `wal_sender_timeout` value in the primary database is set to at least 10 seconds less than the `efm.node.timeout` value. Starting with Failover Manager version 5.0, the num_sync check happens periodically and not as a result of cluster changes.


<div id="check_num_sync_period" class="registered_link"></div>

Use the `check.num.sync.period` property to define the period in seconds between checks to see if the primary database has more or fewer synchronous standbys than it requires. If the `reconfigure.num.sync` or `reconfigure.sync.primary` properties are set to true, Failover Manager will change `synchronous_standby_names` on the primary as needed. If both properties are false, Failover Manager will send a notification if the primary no longer has the required number of synchronous standbys.

```ini
# Period in seconds between checking if the primary database has more or fewer
# synchronous standbys than it requires. If the reconfigure.num.sync or
# reconfigure.sync.primary properties are used, Failover Manager will change
# synchronous_standby_names on the primary as needed. If the primary
# database is not in synchronous mode, this property has no effect.
check.num.sync.period=30
```

!!! Note

    To avoid filling the agent log, Failover Manager will log information about synchronous standbys on the primary node at DEBUG level. This information can be logged at INFO level as desired by running the `efm cluster-status` command (on any node). Periodic background status checks will also cause the information to be logged.

<div id="minimum_standbys" class="registered_link"></div>

Use the `minimum.standbys` property to specify the minimum number of standby nodes to retain on a cluster. If the standby count drops to the specified minimum, a replica node isn't promoted if a failure of the primary node occurs.

```ini
# Instead of setting specific standbys as being unavailable for
# promotion, this property can be used to set a minimum number
# of standbys that will not be promoted. Set to one, for
# example, promotion will not happen if it will drop the number
# of standbys below this value. This property must be the same on
# each node.
minimum.standbys=0
```

<div id="priority_standbys" class="registered_link"></div>

Use the `priority.standbys` property to specify the priority of standbys after this node is promoted.

```ini
# Space-separated list of standby addresses that are high priority for
# promotion when this node is the primary. If set, when this node is
# promoted, addresses in this list will be added to the front of the
# standby priority list. If this list contains addresses that are not
# standbys at the time of promotion, they will not be added.
priority.standbys=
```

<div id="recovery_check_period" class="registered_link"></div>

Use the `recovery.check.period` property to specify the number of seconds for Failover Manager to wait before it checks to see if a database is out of recovery.

```ini
# Time in seconds between checks to see if a promoting database
# is out of recovery.
recovery.check.period=1
```

<div id="restart_connection_timeout" class="registered_link"></div>

Use the `restart.connection.timeout` property to specify the number of seconds for Failover Manager to attempt to connect to a newly reconfigured primary or standby node while the database on that node prepares to accept connections.

```ini
# Time in seconds to keep trying to connect to a database after a start
# or restart command returns successfully but the database is not
# ready to accept connections yet (a rare occurrence). This applies to
# standby databases that are restarted when being reconfigured for a new
# primary, and to primary databases that are stopped and started as
# standbys during a switchover.
#
# This retry mechanism is unrelated to the auto.resume.*.period parameters.
restart.connection.timeout=60
```

<div id="auto_resume_startup_period" class="registered_link"></div>

Use the `auto.resume.startup.period` property to specify the number of seconds for an agent to attempt to resume monitoring that database. This property applies when starting in IDLE mode.

```ini
# Period in seconds for agents to try to resume monitoring when starting
# in IDLE mode. Set to 0 for agents to not try to resume (in which case
# the 'efm resume <cluster>' command is used after bringing a database up).
auto.resume.startup.period=0
```

<div id="auto_resume_failure_period" class="registered_link"></div>

Use the `auto.resume.failure.period` property to specify the number of seconds for an agent to attempt to resume monitoring that database. This property applies after a monitored database fails and an agent has assumed an idle state.

```ini
# Period in seconds for IDLE agents to try to resume monitoring after
# a database failure. Set to 0 for agents to not try to resume (in
# which case the 'efm resume <cluster>' command is used after
# bringing a database back up).
auto.resume.failure.period=0
```

!!!Note
   In Failover Manager version 4.x, there was a single property `auto.resume.period` that controlled both behaviors. If upgrading your configuration from 4.x to 5.x, the upgrade utility will keep your original value for `auto.resume.startup.period` and default `auto.resume.failure.period` to zero.

<div id="virtual_ip" class="registered_link"></div>

Failover Manager provides support for clusters that use a virtual IP. If your cluster uses a virtual IP, provide the host name or IP address in the `virtual.ip` property. Specify the corresponding prefix in the `virtual.ip.prefix` property. Leave `virtual.ip` to disable virtual IP support.

Use the `virtual.ip.interface` property to provide the network interface used by the VIP.

The specified virtual IP address is assigned only to the primary node of the cluster. If you specify `virtual.ip.single=true`, the same VIP address is used on the new primary if a failover occurs. Specify a value of `false` to provide a unique IP address for each node of the cluster.

For information about using a virtual IP address, see [Using Failover Manager with virtual IP addresses](05_using_vip_addresses/#using_vip_addresses).

```ini
# These properties specify the IP and prefix length that will be
# remapped during failover. If you do not use a VIP as part of
# your failover solution, leave the virtual.ip property blank to
# disable Failover Manager support for VIP processing (assigning,
# releasing, testing reachability, etc).
#
# If you specify a VIP, the interface and prefix are required.
#
# If you specify a host name, it will be resolved to an IP address
# when acquiring or releasing the VIP. If the host name resolves
# to more than one IP address, there is no way to predict which
# address Failover Manager will use.
#
# By default, the virtual.ip and virtual.ip.prefix values must be
# the same across all agents. If you set virtual.ip.single to
# false, you can specify unique values for virtual.ip and
# virtual.ip.prefix on each node.
#
# If you are using an IPv4 address, the virtual.ip.interface value
# should not contain a secondary virtual ip id (do not include
# ":1", etc).
virtual.ip=
virtual.ip.interface=
virtual.ip.prefix=
virtual.ip.single=true
```

!!! Note
    If a primary agent starts and the node doesn't currently have the VIP, the Failover Manager agent acquires it. Stopping a primary agent doesn't drop the VIP from the node.

<div id="check_vip_before_promotion" class="registered_link"></div>

Set the `check.vip.before.promotion` property to `false` to prevent Failover Manager from checking to see if a VIP is in use before assigning it to a new primary in case of a failure. This might result in multiple nodes broadcasting on the same VIP address. Unless the primary node is isolated or can be shut down via another process, set this property `to true`.

```ini
# Whether to check if the VIP (when used) is still in use before
# promoting after a primary failure. Turning this off may allow
# the new primary to have the VIP even though another node is also
# broadcasting it. This should only be used in environments where
# it is known that the failed primary node will be isolated or
# shut down through other means.
check.vip.before.promotion=true
```

<div id="check_vip_timeout" class="registered_link"></div>

If there is a possibility that the VIP might take longer than the default 60 seconds to become unreachable, use the `check.vip.timeout` property to increase the maximum time Failover Manager will wait.

```ini
# If check.vip.before.promotion is set to true, use this property to set
# the total amount of time in seconds to wait for the VIP (when used) to
# become unreachable.
check.vip.timeout=60
```

<div id="release_vip_background" class="registered_link"></div>

The `release.vip.*` properties can be used to control the timing of when the VIP is released from a node. See [Using Failover Manager with virtual IP addresses](05_using_vip_addresses/#using_vip_addresses) for more information.

```ini
# In certain networks, there can be errors trying to connect to remote databases
# at the same time the VIP is being released (i.e. on the primary node during a
# switchover). Set the release.vip.background property to false to have the agent
# pause while the VIP is being released. The pre and post wait periods can add
# time (in seconds) to wait before and after the VIP is released in case there
# are other network effects that require them.
release.vip.background=true
release.vip.pre.wait=0
release.vip.post.wait=0
```

<div id="pgpool_enable" class="registered_link"></div>

Use the `pgpool.enable` property to specify if you want to enable the Failover Manager and Pgpool integration for high availability. If you want to enable Pgpool integration in a non-sudo mode (running as the DB owner), the PCPPASS file must be owned by the DB owner operating system user and you must set the file permissions to 600.


```ini
# A boolean property to enable Failover Manager managed Pgpool HA.
# If enabled, Failover Manager would natively update the joining
# and leaving status of database nodes to active pgpool instance.
# Failover manager expects properly configured and running pgpool
# instances on required nodes. It does not manage setup and
# configuration of pgpool on any node.
#
# By default the property is disabled.
pgpool.enable=false
```

Use the following parameters to specify the values to use for Pgpool integration.

```ini
# Configurations required for pgpool integration.
# 'pcp.user' - User that would be invoking PCP commands
# 'pcp.host' - Virtual IP that would be used by pgpool. Same as
# pgpool parameter 'delegate_IP'
# 'pcp.port' - The port on which pgpool listens for pcp commands.
# 'pcp.pass.file' - Absolute path of PCPPASSFILE.
# 'pgpool.bin' - Absolute path of pgpool bin directory

# These properties are required if 'pgpool.enable' is set to true.
pcp.user=
pcp.host=
pcp.port=
pcp.pass.file=
pgpool.bin=
```

<div id="script_load_balancer" class="registered_link"></div>

Use the following properties to provide paths to scripts that reconfigure your load balancer in case of a switchover or primary failure scenario. The scripts are also invoked when a standby failure occurs. If you're using these properties, provide them on every node of the cluster (primary, standby, and witness) to ensure that if a database node fails, another node will call the detach script with the failed node's address.

You don't need to set the following properties if you are using Pgpool as the load balancer solution and you have set the Pgpool integration properties.

Provide a script named after the `script.load.balancer.attach` property to identify a script to invoke when you want to attach a node to the load balancer. Use the `script.load.balancer.detach` property to specify the name of a script to invoke when you want to detach node from the load balancer. Include the `%h` placeholder to represent the IP address of the node that's being attached or removed from the cluster. Include the `%t` placeholder to instruct Failover Manager to include a p (for a primary node) or an s (for a standby node) in the string.

```ini
# Absolute path to load balancer scripts
# The attach script is called when a node should be attached to
# the load balancer, for example after a promotion. The detach
# script is called when a node should be removed, for example
# when a database has failed or is about to be stopped. Use %h to
# represent the IP/hostname of the node that is being
# attached/detached. Use %t to represent the type of node being
# attached or detached: the letter m will be passed in for primary nodes
#and the letter s for standby nodes.
#
# Example:
# script.load.balancer.attach=/somepath/attachscript %h %t
script.load.balancer.attach=
script.load.balancer.detach=
```

<div id="detach_on_agent_failure" class="registered_link"></div>

In 5.0 and later versions, this value is set to `false` by default, meaning that Failover Manager doesn't detach nodes from the load balancer in the unlikely event that the primary agent fails, but the database is still reachable. In earlier versions, the default was set to `true`. Set to `true` only if you need the value to be backwards compatible with an early Failover Manager behavior.

```ini
# If set to true, Failover Manager will detach the node from load
# balancer if the primary agent fails but the database is still
# reachable. In most scenarios this is NOT the desired situation. In
# scenarios where the detach script should run with a failed primary
# agent, even when the primary database is still healthy this parameter
# should be set to true. If no value specified it defaults to true (for
# backwards compatibility).
# This is not applicable for standbys.
detach.on.agent.failure=
```

<div id="script_fence" class="registered_link"></div>

The `script.fence` property specifies the path to an optional user-supplied script to invoke during the promotion of a standby node to primary node.

```ini
# absolute path to fencing script run during promotion
#
# This is an optional user-supplied script that will be run
# during failover on the standby database node. If left blank,
# no action will be taken. If specified, EFM will execute this
# script before promoting the standby.
#
# Parameters can be passed into this script for the failed primary
# and new primary node addresses. Use %p for new primary and %f
# for failed primary. On a node that has just been promoted, %p
# should be the same as the node's efm binding address.
#
# Example:
# script.fence=/somepath/myscript %p %f
#
# NOTE: FAILOVER WILL NOT OCCUR IF THIS SCRIPT RETURNS A NON-ZERO EXIT
# CODE.
script.fence=
```

<div id="script_post_promotion" class="registered_link"></div>

Use the `script.post.promotion` property to specify the path to an optional user-supplied script to invoke after a standby node is promoted to primary.

```ini
# Absolute path to fencing script run after promotion
#
# This is an optional user-supplied script that will be run after
# failover on the standby node after it has been promoted and
# is no longer in recovery. The exit code from this script has
# no effect on failover manager, but will be included in a
# notification sent after the script executes.
#
# Parameters can be passed into this script for the failed primary
# and new primary node addresses. Use %p for new primary and %f
# for failed primary. On a node that has just been promoted, %p
# should be the same as the node's efm binding address.
#
# Example:
# script.post.promotion=/somepath/myscript %f %p
script.post.promotion=
```

<div id="script_resumed" class="registered_link"></div>

Use the `script.resumed` property to specify an optional path to a user-supplied script to invoke when an agent resumes monitoring a database.

```ini
# Absolute path to resume script
#
# This script is run before an IDLE agent resumes
# monitoring its local database.
script.resumed=
```

<div id="script_db_failure" class="registered_link"></div>

Use the `script.db.failure` property to specify the complete path to an optional user-supplied script that Failover Manager invokes if an agent detects that the database that it monitors has failed.

```ini
# Absolute path to script run after database failure
# This is an optional user-supplied script that will be run after
# an agent detects that its local database has failed.
script.db.failure=
```

<div id="script_primary_isolated" class="registered_link"></div>

Use the `script.primary.isolated` property to specify the complete path to an optional user-supplied script that Failover Manager invokes if the agent monitoring the primary database detects that the primary is isolated from the majority of the Failover Manager cluster. This script is called immediately after the VIP is released (if a VIP is in use).

```ini
# Absolute path to script run on isolated primary
# This is an optional user-supplied script that will be run after
# a primary agent detects that it has been isolated from the
# majority of the efm cluster.
script.primary.isolated=
```

<div id="script_remote_pre_promotion" class="registered_link"></div>

Use the `script.remote.pre.promotion` property to specify the path and name of a script to invoke on any agent nodes not involved in the promotion when a node is about to promote its database to primary.

Include the %p placeholder to identify the address of the new primary node.

```ini
# Absolute path to script invoked on non-promoting agent nodes
# before a promotion.
#
# This optional user-supplied script will be invoked on other
# agents when a node is about to promote its database. The exit
# code from this script has no effect on Failover Manager, but
# will be included in a notification sent after the script
# executes.
#
# Pass a parameter (%p) with the script to identify the new
# primary node address.
#
# Example:
# script.remote.pre.promotion=/path_name/script_name %p
script.remote.pre.promotion=
```

<div id="script_remote_post_promotion" class="registered_link"></div>

Use the `script.remote.post.promotion` property to specify the path and name of a script to invoke on any nonprimary nodes after a promotion occurs.

Include the %p placeholder to identify the address of the new primary node.

```ini
# Absolute path to script invoked on non-primary agent nodes
# after a promotion.
#
# This optional user-supplied script will be invoked on nodes
# (except the new primary) after a promotion occurs. The exit code
# from this script has no effect on Failover Manager, but will be
# included in a notification sent after the script executes.
#
# Pass a parameter (%p) with the script to identify the new
# primary node address.
#
# Example:
# script.remote.post.promotion=/path_name/script_name %p
script.remote.post.promotion=
```

<div id="script_custom_monitor" class="registered_link"></div>

Use the `script.custom.monitor` property to provide the name and location of an optional script to invoke on regular intervals, specified in seconds by the `custom.monitor.interval` property.

Use `custom.monitor.timeout` to specify the maximum time for the script to run. If script execution doesn't finish in the time specified, Failover Manager sends a notification.

Set `custom.monitor.safe.mode` to `true` to instruct Failover Manager to report nonzero exit codes from the script but not promote a standby as a result of an exit code.

```ini
# Absolute path to a custom monitoring script.
#
# Use script.custom.monitor to specify the location and name of
# an optional user-supplied script that will be invoked
# periodically to perform custom monitoring tasks. A non-zero
# exit value means that a check has failed; this will be treated
# as a database failure. On a primary node, script failure will
# cause a promotion. On a standby node script failure will
# generate a notification and the agent will become IDLE.
#
# The custom.monitor.\* properties are required if a custom
# monitoring script is specified:
#
# custom.monitor.interval is the time in seconds between executions
# of the script.
#
# custom.monitor.timeout is a timeout value in seconds for how
# long the script will be allowed to run. If script execution
# exceeds the specified time, the task will be stopped and a
# notification sent. Subsequent runs will continue.
#
# If custom.monitor.safe.mode is set to true, non-zero exit codes
# from the script will be reported but will not cause a promotion
# or be treated as a database failure. This allows testing of the
# script without affecting EFM.
#
script.custom.monitor=
custom.monitor.interval=
custom.monitor.timeout=
custom.monitor.safe.mode=
```

<div id="sudo_command" class="registered_link"></div>

Use the `sudo.command` property to specify a command for Failover Manager to invoke when performing tasks that require extended permissions. Use this option to include command options that might be specific to your system authentication.

Use the `sudo.user.command` property to specify a command for Failover Manager to invoke when executing commands performed by the database owner.

```ini
# Command to use in place of 'sudo' if desired when efm runs
# the efm_db_functions or efm_root_functions, or efm_address
# scripts.
# Sudo is used in the following ways by efm:
#
# sudo /usr/edb/efm-<version>/bin/efm_address <arguments>
# sudo /usr/edb/efm-<version>/bin/efm_root_functions <arguments>
# sudo -u <db service owner> /usr/edb/efm-<version>/bin/efm_db_functions <arguments>
#
# 'sudo' in the first two examples will be replaced by the value
# of the sudo.command property. 'sudo -u <db service owner>' will
# be replaced by the value of the sudo.user.command property.
# The '%u' field will be replaced with the db owner.
sudo.command=sudo
sudo.user.command=sudo -u %u
```

<div id="lock_dir" class="registered_link"></div>

Use the `lock.dir` property to specify an alternative location for the Failover Manager lock file. The file prevents Failover Manager from starting multiple, potentially orphaned, agents for a single cluster on the node.

```ini
# Specify the directory of lock file on the node. Failover
# Manager creates a file named <cluster>.lock at this location to
# avoid starting multiple agents for same cluster. If the path
# does not exist, Failover Manager will attempt to create it. If
# not specified defaults to '/var/lock/efm-<version>'
lock.dir=
```

<div id="log_dir" class="registered_link"></div>

Use the `log.dir` property to specify the location to write agent log files. Failover Manager attempts to create the directory if the directory doesn't exist. The `log.dir` parameter defined in the `efm.properties` file determines the directory path where the EFM logs are stored. This parameter applies exclusively to the EFM logs and doesn't affect the logging configuration for any other components or services.

To change the startup log location for EFM versions 4.x, modify the `runefm.sh` script located in the EFM bin directory. Set the `LOG` parameter in this script to define the desired log file location.

```ini
# Specify the directory of agent logs on the node. If the path does not exist,
# Failover Manager will attempt to create it.
# If not specified defaults to '/var/log/efm-<version>'.
# If using a custom log directory, you must configure logrotate separately.
# Use 'man logrotate' for more information.
log.dir=
```

<div id="syslog_logging" class="registered_link"></div>

After enabling the UDP or TCP protocol on a Failover Manager host, you can enable logging to syslog. Use the `syslog.protocol` parameter to specify the protocol type (UDP or TCP) and the `syslog.port` parameter to specify the listener port of the syslog host. You can use the `syslog.facility` value as an identifier for the process that created the entry. Use a value between LOCAL0 and LOCAL7.

```ini
# Syslog information. The syslog service must be listening on
# the port for the given protocol, which can be UDP or TCP.
# The facilities supported are LOCAL0 through LOCAL7.
syslog.host=localhost
syslog.port=514
syslog.protocol=UDP
syslog.facility=LOCAL1
```

<div id="logtype_enabled" class="registered_link"></div>

Use the `file.log.enabled` and `syslog.enabled` properties to specify the type of logging that you want to implement. Set `file.log.enabled` to `true` to enable logging to a file. Enable the UDP protocol or TCP protocol and set `syslog.enabled` to `true` to enable logging to syslog. You can enable logging to both a file and syslog.

```ini
# Which logging is enabled.
file.log.enabled=true
syslog.enabled=false
```

For more information about configuring syslog logging, see [Enabling syslog log file entries](../09_controlling_logging/#enabling_syslog).

<div id="loglevel" class="registered_link"></div>

Use the `jgroups.loglevel`, `efm.loglevel`, and `jdbc. loglevel` parameters to specify the level of detail logged by Failover Manager. The default value is `INFO`. For more information about logging, see [Controlling logging](../09_controlling_logging/#controlling_logging).

```ini
# Logging levels for JGroups and EFM.
# Valid values are: TRACE, DEBUG, INFO, WARN, ERROR
# Default value: INFO
# It is not necessary to increase these values unless debugging a specific
# issue. If nodes are not discovering each other at startup, increasing
# the jgroups level to DEBUG will show information about the TCP connection
# attempts that may help diagnose the connection failures.
# If there are issues with creating database connections, increasing
# the jdbc.loglevel level will show more information.
# TRACE level logging should be used for diagnosing problems only.
# It is not supported for production use.
jgroups.loglevel=INFO
efm.loglevel=INFO
jdbc.loglevel=INFO
```

<div id="jvm_options" class="registered_link"></div>

Use the `jvm.options` property to pass JVM-related configuration information. The default setting specifies the amount of memory that the Failover Manager agent can use.

```ini
# Extra information that will be passed to the JVM when starting
# the agent.
jvm.options=-Xmx128m
```

<div class="toctree" maxdepth="3">

encrypting_database_password

</div>
