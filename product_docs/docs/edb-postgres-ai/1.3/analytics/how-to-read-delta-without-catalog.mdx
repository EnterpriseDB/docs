---
title: How-to  Read Delta Lake tables without a catalog
navTitle: Read Delta (no catalog)
description: Run read-only analytics on Delta Lake tables from EDB Postgres AI Lakehouse clusters in Hybrid Manager without a catalog.
---

# Read-only analytics without a catalog: Delta Lake

This guide shows how to run read-only analytics on Delta Lake datasets directly from your EDB Postgres Lakehouse cluster using Seafowl and PGAA.

## Configure PGD for faster testing

```sql
SET bdr.taskmgr_nap_time = 10000;
SET pgaa.max_replication_lag_s = 5;
SET pgaa.flush_task_interval_s = 5;

CREATE EXTENSION IF NOT EXISTS pgaa CASCADE;
```

## Create a storage location and start Seafowl

```sql
SELECT bdr.replicate_ddl_command($$
  SELECT pgfs.create_storage_location(
    'biganimal-sample-data',
    's3://beacon-analytics-demo-data-us-east-1-prod',
    '{"aws_skip_signature": "true"}'
  );
$$);

SELECT bdr.alter_node_group_option(
  (SELECT node_group_name FROM bdr.node_group WHERE node_group_name != 'world' LIMIT 1),
  'analytics_storage_location',
  'biganimal-sample-data'
);

SELECT application_name FROM pg_stat_activity WHERE application_name LIKE '%seafowl%';
```

## Create external tables and run a query

```sql
CREATE TABLE public.customer () USING PGAA
WITH (pgaa.storage_location = 'biganimal-sample-data', pgaa.path = 'tpch_sf_1/customer');
CREATE TABLE public.lineitem () USING PGAA
WITH (pgaa.storage_location = 'biganimal-sample-data', pgaa.path = 'tpch_sf_1/lineitem');
CREATE TABLE public.nation () USING PGAA
WITH (pgaa.storage_location = 'biganimal-sample-data', pgaa.path = 'tpch_sf_1/nation');
CREATE TABLE public.orders () USING PGAA
WITH (pgaa.storage_location = 'biganimal-sample-data', pgaa.path = 'tpch_sf_1/orders');
CREATE TABLE public.part () USING PGAA
WITH (pgaa.storage_location = 'biganimal-sample-data', pgaa.path = 'tpch_sf_1/part');
CREATE TABLE public.partsupp () USING PGAA
WITH (pgaa.storage_location = 'biganimal-sample-data', pgaa.path = 'tpch_sf_1/partsupp');
CREATE TABLE public.region () USING PGAA
WITH (pgaa.storage_location = 'biganimal-sample-data', pgaa.path = 'tpch_sf_1/region');
CREATE TABLE public.supplier () USING PGAA
WITH (pgaa.storage_location = 'biganimal-sample-data', pgaa.path = 'tpch_sf_1/supplier');

SELECT
    c_custkey,
    c_name,
    sum(l_extendedprice * (1 - l_discount)) AS revenue,
    c_acctbal,
    n_name,
    c_address,
    c_phone,
    c_comment
FROM customer, orders, lineitem, nation
WHERE c_custkey = o_custkey
  AND l_orderkey = o_orderkey
  AND o_orderdate >= CAST('1993-10-01' AS date)
  AND o_orderdate < CAST('1994-01-01' AS date)
  AND l_returnflag = 'R'
  AND c_nationkey = n_nationkey
GROUP BY c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment
ORDER BY revenue DESC
LIMIT 20;
```

## Inspect table statistics

```sql
SELECT * FROM pgaa.lakehouse_table_stats('lineitem'::regclass);
```
