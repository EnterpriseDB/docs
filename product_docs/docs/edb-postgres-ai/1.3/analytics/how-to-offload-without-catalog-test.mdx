---
title: How-to  PGD offloads without a catalog (test)
navTitle: Offload w/o catalog test
description: Create and offload a transactional table to Iceberg without a catalog; verify reads from Lakehouse.
---

## Create and populate a transactional table

```sql
CREATE TABLE transactional_table (
  key BIGINT,
  inserted_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  revenue DOUBLE PRECISION,
  comment TEXT,
  PRIMARY KEY (key, inserted_at)
);

INSERT INTO transactional_table (
  SELECT
    g,
    '2010-01-01 00:00:00'::timestamp + INTERVAL '1 second' *
      (EXTRACT (EPOCH FROM (CURRENT_TIMESTAMP - '2010-01-01 00:00:00'::timestamp)) / 1000000 * g),
    g * 0.001,
    encode(sha256(g::text::bytea), 'hex')
  FROM generate_series(1, 1000000) g
);
```

## Offload and verify reads from Lakehouse

```sql
ALTER TABLE transactional_table SET (pgd.replicate_to_analytics = TRUE);
SELECT * FROM bdr.analytics_table; -- wait until initial sync finishes

CREATE TABLE transactional_table_analytics_reader ()
USING PGAA
WITH (
  pgaa.format = 'iceberg',
  pgaa.storage_location = 'appliance-bucket',
  pgaa.path = 'public.transactional_table'
);

SELECT COUNT(*) AS count, ROUND(SUM(revenue)) AS total_revenue FROM transactional_table_analytics_reader;
```

