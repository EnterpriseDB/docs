---
title: Sync container images to your registry
navTitle: Sync container images
description: Learn how to sync Hybrid Manager container images from EDB Repos 2.0 to your private container registry.
---

The Hybrid Manager software stack is distributed through the EDB Repos 2.0 registry. Before installing or upgrading Hybrid Manager, you need to sync these container images to your own secure, approved internal registry.

For AWS EKS deployments, this is typically an Amazon Elastic Container Registry (ECR) in the same AWS account, though other supported container registries can also be used.

## Why sync images?

The sync process ensures:

- **Security**: Images are hosted in your organization's approved registry
- **Immutability**: SHA256 digests are preserved across environments
- **Compliance**: You control where container images are stored
- **Availability**: Images remain accessible even if external registries are unavailable

## Prerequisites

Before syncing images, ensure you have:

- The Hybrid Manager version you want to install
- An EDB Repos 2.0 access token with read permissions
- Access to your destination container registry with push permissions
- Either `edbctl` or `skopeo` installed on your system

!!!note AWS ECR-specific requirement
If using AWS ECR as your destination registry, you must create separate repositories for each image since ECR doesn't support images with multiple slashes in their names to be saved in the same repository. See the [AWS ECR documentation](https://docs.aws.amazon.com/AmazonECR/latest/userguide/repository-create.html) for more details.
!!!

## Option 1: Using edbctl (Recommended)

`edbctl` is the CLI tool for managing Hybrid Manager resources and provides the simplest way to sync images.

### Install edbctl

Before using `edbctl`, you need to install it on your system. See the [edbctl installation guide](../../using_hybrid_manager/edbctl/) for detailed instructions on how to install and configure the CLI tool.

### Sync platform images

Configure the required environment variables and run the sync command:

```bash
# Configure the HM release version
export HM_RELEASE=<RELEASE_VERSION>

# Configure the EDB Repos 2.0 access token
export EDB_TOKEN=<EDB_TOKEN>

# Configure the EDB Repos 2.0 registry source
export EDB_SOURCE_REGISTRY=pgai-platform

# Run the sync-to-local-registry command
edbctl image sync-to-local-registry \
    --destination-registry-uri "<LOCAL_REGISTRY_URI>" \
    --version "${HM_RELEASE}" \
    --source-registry-username "${EDB_SOURCE_REGISTRY}" \
    --source-registry-password "${EDB_TOKEN}" \
    --destination-registry-username "<LOCAL_REGISTRY_USER>" \
    --destination-registry-password "<LOCAL_REGISTRY_PWD>"
```

Replace the placeholders:
- `<RELEASE_VERSION>`: The HM version (e.g., `v2025.12.0`)
- `<EDB_TOKEN>`: Your EDB Repos 2.0 access token
- `<LOCAL_REGISTRY_URI>`: Your destination registry URI
- `<LOCAL_REGISTRY_USER>`: Username for your destination registry
- `<LOCAL_REGISTRY_PWD>`: Password for your destination registry

#### AWS ECR example

For AWS ECR, when you run the sync command, `edbctl` will detect ECR and prompt for confirmation, then provide a code snippet with AWS CLI commands to pre-create all required repositories.

```bash
# Example for AWS ECR
export AWS_ACCOUNT_ID=123456789012
export AWS_REGION=us-east-1

edbctl image sync-to-local-registry \
    --destination-registry-uri "${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.amazonaws.com/edbhm" \
    --version "${HM_RELEASE}" \
    --source-registry-username "${EDB_SOURCE_REGISTRY}" \
    --source-registry-password "${EDB_TOKEN}" \
    --destination-registry-username "AWS" \
    --destination-registry-password "$(aws ecr get-login-password --region ${AWS_REGION})"
```

### Sync the Operator image

```bash
# Sync the HM Operator image
edbctl operator sync-to-local-registry \
    --destination-registry-uri "<LOCAL_REGISTRY_URI>" \
    --version "${HM_RELEASE}" \
    --source-registry-username "${EDB_SOURCE_REGISTRY}" \
    --source-registry-password "${EDB_TOKEN}" \
    --destination-registry-username "<LOCAL_REGISTRY_USER>" \
    --destination-registry-password "<LOCAL_REGISTRY_PWD>"
```

## Option 2: Using skopeo

[Skopeo](https://github.com/containers/skopeo) is an open-source tool for working with container images. You can use it to sync images if you prefer not to use `edbctl`.

### Install skopeo

Follow the [official skopeo installation instructions](https://github.com/containers/skopeo/blob/main/install.md) for your operating system.

### Download the image list

Each Hybrid Manager release provides an artifact containing the list of all required container images:

```bash
# Configure the HM release version
export HM_RELEASE=<RELEASE_VERSION>

# Configure the EDB Repos 2.0 access token
export EDB_TOKEN=<EDB_TOKEN>

# Download the image list artifact
curl -sLO "https://downloads.enterprisedb.com/${EDB_TOKEN}/pgai-platform/raw/names/${HM_RELEASE}-images.txt/versions/${HM_RELEASE}/images.txt"
```

### Authenticate to registries

```bash
# Configure registries
export EDB_SOURCE_REGISTRY=docker.enterprisedb.com/pgai-platform
export LOCAL_REGISTRY_URI=<LOCAL_REGISTRY_ADDRESS>

# Login to EDB Repos 2.0 source registry
skopeo login docker.enterprisedb.com

# Login to destination registry
skopeo login <LOCAL_REGISTRY_ADDRESS>
```

### Sync all images

```bash
# Parse the image list and sync each image
while read -r image; do
  skopeo --override-os linux copy \
    --multi-arch all \
    docker://$EDB_SOURCE_REGISTRY/${image/:*@/@} \
    docker://$LOCAL_REGISTRY_URI/${image/:*@/@} \
    --retry-times 3
done < images.txt
```

### Sync the Operator image

```bash
# Sync the HM Operator image
skopeo --override-os linux copy \
    --multi-arch all \
    docker://${EDB_SOURCE_REGISTRY}/edb-hcp-operator/manager:${HM_RELEASE} \
    docker://${LOCAL_REGISTRY_URI}/edb-hcp-operator/manager:${HM_RELEASE} \
    --retry-times 3
```

## Example: Complete AWS ECR workflow with skopeo

Here's a complete example showing the image sync process using AWS ECR as the destination registry:

```bash
# Set up environment
export HM_RELEASE=v2025.12.0
export EDB_TOKEN=<EDB_TOKEN>
export AWS_ACCOUNT_ID=123456789012
export AWS_REGION=us-east-1

# Download image list
curl -sLO "https://downloads.enterprisedb.com/${EDB_TOKEN}/pgai-platform/raw/names/${HM_RELEASE}-images.txt/versions/${HM_RELEASE}/images.txt"

# Check number of images
wc -l images.txt
# Output: 132 images.txt

# Configure registries
export EDB_SOURCE_REGISTRY=docker.enterprisedb.com/pgai-platform
export LOCAL_REGISTRY_URI=${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.amazonaws.com/edbhm

# Login to registries
skopeo login docker.enterprisedb.com
# Username: <enter username>
# Password: <enter password>
# Login Succeeded!

skopeo login ${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.amazonaws.com \
  -u AWS \
  -p $(aws ecr get-login-password --region ${AWS_REGION})
# Login Succeeded!

# Pre-create ECR repositories and sync images
# Note: AWS RepositoryAlreadyExistsException errors can be ignored
while read -r image; do
  # Create ECR repository (ignore if exists)
  aws ecr create-repository \
    --repository-name "${LOCAL_REGISTRY_URI#*/}/${image%%[:@]*}" \
    --region ${AWS_REGION} \
    --no-cli-pager || true

  # Copy image
  skopeo --override-os linux copy \
    --multi-arch all \
    docker://$EDB_SOURCE_REGISTRY/${image/:*@/@} \
    docker://$LOCAL_REGISTRY_URI/${image/:*@/@} \
    --retry-times 3
done < images.txt

# Verify sync results
aws ecr describe-repositories \
  --query 'repositories[?starts_with(repositoryName, `edbhm`)]' \
  --region ${AWS_REGION} \
  --output json | jq '. | length'
# Output: 93

cat images.txt | awk -F'[:@]' '{print $1}' | sort -u | wc -l
# Output: 93
# âœ“ Image count matches repository count

# Sync the operator image
skopeo --override-os linux copy \
    --multi-arch all \
    docker://${EDB_SOURCE_REGISTRY}/edb-hcp-operator/manager:${HM_RELEASE} \
    docker://${LOCAL_REGISTRY_URI}/edb-hcp-operator/manager:${HM_RELEASE} \
    --retry-times 3
```

!!!note
The sync process typically takes several minutes to complete depending on your network speed and the number of images in the release.
!!!

## Next steps

After syncing the container images to your private registry, proceed with the [Hybrid Manager installation](../installing).
