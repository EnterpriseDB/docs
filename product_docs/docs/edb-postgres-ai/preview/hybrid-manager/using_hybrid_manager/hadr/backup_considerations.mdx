---
title: HA/DR backup considerations
navTitle: Backup considerations
description: Learn about backup requirements and understand what RTO and RPO times to expect when restoring your HM instance and Postgres clusters.
---

Disaster can affect Hybrid Manager (HM) and make it unusable. For example, unavailability of the underlying Cloud Service Provider (CSP) region or an outage in a data center that makes hardware unusable can occur. A disaster recovery (DR) option allows you to restore your databases at the point-in-time from your available backups.

HM backups are handled with [Velero](https://velero.io/).

There are two possible scenarios for recovering HM:

-   **Restore HM to original location**: You have two data centers (DC1, DC2), and HM runs in DC1. You need to restore HM from object storage to DC1.

-   **Restore HM to alternative location**: You have two data centers (DC1, DC2), and HM runs in DC1. You need to restore HM from object storage to DC2.

## Disaster recovery (DR) scope

You can use the DR procedure to restore:

-   The HM console and its applications.
-   The Postgres clusters that you created with HM.
-   For HM environments with [multi-DC enabled](/edb-postgres-ai/preview/hybrid-manager/using_hybrid_manager/multi-dc/), you can restore the custom managed storage locations as you defined them in the associated s3-compatible storage area.

!!! note
    The DR procedures don't cover the migration components. However, you can apply the DR procedure to restore the original databases of HM-internal `transporter-db` and `migration-db` services.

## RTO and RPO

The ability to do any restore, the associated recovery time objective (RTO), and recovery point objective (RPO) depend on the frequency and size of the backups.

- The RTO will be determined by the time it takes to deploy a new HM instance and restore the HM control plane and Postgres clusters (data plane) from the available backups. The RTO will be affected by the size of the Postgres clusters, the number of Postgres clusters, and the size of the HM control plane data.

- The RPO will be determined by the frequency of the backups and the backup lifecycle policies. Critical data, such as the definition of the Postgres clusters, is stored as Kubernetes objects and included in the Velero backup. By default, this backup happens daily at 23:00, as defined by the default schedule `velero-backup-kube-state`. If your RPO requires more frequent backups, complement the default schedule by creating an additional custom backup schedules.

As those factors have significant variation depending on the criticality assigned to the environment and the nature of your data, you don't know RTO and RPO values in advance. We recommend that you properly prepare the environment and perform periodic disaster recovery exercises to ensure your RTO and RPO requirements can be met. 

## Backup readiness

During installation, you configure an [s3-compatible storage](/edb-postgres-ai/preview/hybrid-manager/install/sys_reqs/#7-object-storage) for your HM instance that stores:

-   Internal backups (HM control plane data)
-   Postgres backups (Postgres database backups or data plane data)

You can also define custom storage locations in the same bucket to be used by your HM instance.

All of this data needs to be available after a disaster. Depending on the criticality of the data and the level of disaster that you want to be able to recover from, youâ€™ll need to replicate this data outside of the CSP region or physical data center where the HM instance resides.

!!! tip
    When using a bucket, you can achieve replication by using cross-regions replication. For example, for AWS S3 buckets, see [cross-region replication](https://docs.aws.amazon.com/AmazonS3/latest/userguide/replication.html#crr-scenario).

Postgres databases use continuous backup by default, so you can restore them at any point in time. They are limited only by backup lifecycle policies.

Critical appliance data, such as the definition of the Postgres clusters, is stored as Kubernetes objects and included in the Velero backup. By default, this backup happens daily at 23:00, as defined by the default schedule `velero-backup-kube-state`.

If your RPO requires more frequent backups, complement the default schedule by creating an additional custom backup schedules.

!!! Danger
    Do not modify the default schedule, as it may be overwritten by a HM software update.

The following example shows a custom schedule to back up the needed resources every 6 hours at the top of the hour:

```shell
velero create schedule <backup-name> --schedule="0 */6 * * *" --include-namespaces='*' --include-resources='*' --snapshot-volumes=false --ttl=168h --skip-immediately=false
```

To check how the backup schedule was configured in the backend, run the following command:

```shell
kubectl get schedules.velero.io example -n velero -o yaml | yq .spec
```

Which should return the following output:

```yaml
schedule: 0 */6 * * *
skipImmediately: false
template:
  csiSnapshotTimeout: 0s
  hooks: {}
  includedNamespaces:
    - '*'
  includedResources:
    - '*'
  itemOperationTimeout: 0s
  metadata: {}
  snapshotVolumes: false
  ttl: 168h0m0s
useOwnerReferencesInBackup: false
```

## Next topic

Now that you have learned about [best practices for DR with HM](hadr), and applied the appropriate backup strategies on this page to meet your RTO and RPO requirements, you can [perform a disaster recovery of your HM instance and Postgres clusters using Velero](hadr_recovery).
