---
title: "Upgrading PostGIS"

legacyRedirectsGenerated:
  # This list is generated by a script. If you need add entries, use the `legacyRedirects` key.
  - "/edb-docs/d/edb-postgres-postgis/user-guides/postgis-guide/1.0/upgrading_postgis.html"
---

<div id="upgrade" class="registered_link"></div>

This section walks you through the following upgrade examples:

- Example 1 - Upgrading from PostGIS version 2.5.4 to PostGIS version 3.0.2 of the same EDB Postgres Advanced Server version 11:
- Example 2 - Upgrading from PostGIS version 2.4.6 for EDB Postgres Advanced server 9.6 to PostGIS version 3.1 for EDB Postgres Advanced server version 13:

## Example 1

The following example walks you through upgrading from PostGIS version 2.5.4 to PostGIS version 3.0.2 of the same EDB Postgres Advanced Server version 11:

1.  Install PostGIS 3.0.2.

2.  To update extensions, connect to the database (where you have already added extensions) with the psql client application, and execute the following commands:

    ```text
    edb=# SELECT postgis_extensions_upgrade();
    NOTICE:  Packaging extension postgis_raster
    NOTICE:  Updating extension postgis_topology from 2.5.4 to 3.0.2
    NOTICE:  Updating extension postgis_tiger_geocoder from 2.5.4 to 3.0.2
                        postgis_extensions_upgrade
    -------------------------------------------------------------------
     Upgrade completed, run SELECT postgis_full_version(); for details
    (1 row)
    ```

## Example 2

The following example walks you through upgrading from PostGIS version 2.4.6 for EDB Postgres Advanced server 9.6 to PostGIS version 3.1 for EDB Postgres Advanced server version 13:

!!! Note

    You can upgrade to PostGIS latest version only for  PostgreSQL version greater than or equal to 9.6. 

1.  Navigate to the bin directory of EDB Advanced Server 9.6 and initialize the cluster:

    ```text
    cd /usr/edb/as9.6/bin/
    ./edb-as-96-setup initdb
    ```

2.  Change the `pg_hba.conf` file authentication setting to `trust` (these should be reversed after compatibility check).

    ```text
    vi /var/lib/edb/as9.6/data/pg_hba.conf
    
    # "local" is for Unix domain socket connections only

    local   all    all                trust

    # IPv4 local connections:

    host    all    all  127.0.0.1/32  trust

    # IPv6 local connections:
    host    all             all             ::1/128                 trust
    ```

    !!! Note
    
        It is assumed that user has already created extensions for PostGIS version 2.4.6.

3. Start the EDB Postgres Advanced Server 9.6 service:

    ```text
    systemctl start edb-as-9.6
    ```

4.  Upgrade the PostGIS version 2.4.6 to version 3.1 for EDB Advanced Server 9.6:

    ```text
    yum upgrade edb-as96-postgis*
    ```

5. To update extensions, switch to an `enterprisedb` user, connect to the database (where you have already added extensions) with the psql client application, and execute the following commands:

    ```text
    su enterprisedb
    ./psql -d edb -p 5444
    SELECT postgis_extensions_upgrade();
    NOTICE: Updating extension postgis from 2.4.6 to 3.1.1
    NOTICE: Updating extension postgis_sfcgal from 2.4.6 to 3.1.1
    NOTICE: Packaging extension postgis_raster
    NOTICE: Updating extension postgis_topology from 2.4.6 to 3.1.1
    NOTICE: Updating extension postgis_tiger_geocoder from 2.4.6 to 3.1.1
          postgis_extensions_upgrade           
    -------------------------------------------------------------------
    Upgrade completed, run SELECT postgis_full_version(); for details
    (1 row)
    exit
    ```
6. Stop the EDB Postgres Advanced Server 9.6 server service:

    ```text
    systemctl stop edb-as-9.6
    ```
7.  Assume the superuser privileges and install the EDB Postgres Advanced Server version 13:

    ```text
    yum install edb-as13-server -y
    ```
8.  Navigate to the bin directory of EDB Advanced Server 13 and initialize the cluster:

    ```text
    cd /usr/edb/as13/bin/
    ./edb-as-13-setup initdb
    ```

9.  Change the `pg_hba.conf` file authentication setting to `trust` (these should be reversed after compatibility check).

    ```text
    vi /var/lib/edb/as13/data/pg_hba.conf 

    # "local" is for Unix domain socket connections only

    local   all    all                trust

    # IPv4 local connections:

    host    all    all  127.0.0.1/32  trust

    # IPv6 local connections:
    host    all             all             ::1/128                 trust
    ```

10. Install the PostGIS version 3.1 for EDB Postgres Advanced Server version 13.0:

    ```text
    yum install edb-as13-postgis3
    ```

11.  Set appropriate permissions to the `/tmp` directory:

    ```text
    chmod 777 /tmp
    ```

12.  Change the current directory to `tmp` and switch to an `enterprisedb` user:

    ```text
    cd /tmp

    su enterprisedb
    ```

13.  Execute the following command to upgrade to EDB Postgres Advanced Server 13:

    ```text
    /usr/edb/as13/bin/pg_upgrade -d /var/lib/edb/as9.6/data/ -D /var/lib/edb/as13/data/ -U enterprisedb -b /usr/edb/as9.6/bin/ -B /usr/edb/as13/bin/ -p 5444 -P 5445 -c

    /usr/edb/as13/bin/pg_upgrade -d /var/lib/edb/as9.6/data/ -D /var/lib/edb/as13/data/ -U enterprisedb -b /usr/edb/as9.6/bin/ -B /usr/edb/as13/bin/ -p 5444 -P 5445 --link
     ```

14. Navigate to the bin directory of EDB Advanced Server 13 and start the service:

    ```text
    cd /usr/edb/as13/bin/
    systemctl start edb-as-13
    systemctl status edb-as-13
    ```

15. To update extensions switch to an `enterprisedb` user, connect to the database (where you have already added extensions) with the psql client application, and execute the following commands:

    ```text
    su enterprisedb
    ./psql -d edb -p 5444
    edb=# SELECT PostGIS_Extensions_Upgrade(); 
    NOTICE: Updating extension postgis 3.1.1
          postgis_extensions_upgrade           
    -------------------------------------------------------------------
    Upgrade completed, run SELECT postgis_full_version(); for details
    (1 row)
    ```