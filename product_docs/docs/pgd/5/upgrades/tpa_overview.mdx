---
title: Upgrading PGD clusters with TPA
---

If you have used TPA to install your cluster, you can also use TPA to upgrade your cluster. You can read more, in detail, about the capabilities of TPA upgrades in the [Upgrading your cluster](/tpa/latest/tpaexec-upgrade/) section of the TPA manual.

!!! Warning Always test first
If possible, always test upgrade processes in a QA environment first to ensure there are no unexpected factors to be taken into account. TPA's ability to reproducibly deploy a PGD configuration makes it much easier to build a test environment to work with.
!!!

## Pre-requisites

* The cluster configuration directory that was created when TPA deployed your PGD cluster. 

## Upgrading

Run

```
tpaexec upgrade clustername
```

Where clustername is the name of the cluster and the path to the cluster configuration directory. By default, TPA will upgrade each node of the cluster to the latest versions of the software the nodes were configured with.

!!! Note TPA's automated rolling upgrade procedure

TPA will test first the cluster then the nodes. Each node will then be isolated from the cluster, upgraded and then returned to operation within the cluster.

* Checks that all preconditions for upgrading the cluster are met.
* For each instance in the cluster, checks that it has the correct repositories configured and that the required postgres packages are available in them.
    * For each BDR node in the cluster, one at a time:
        * Fences the node off to ensure that pgd-proxy doesn't send any connections to it.
        * Stops, updates, and restarts postgres.
        * Unfences the node so it can receive connections again.
        * Updates pgbouncer, pgd-proxy, and pgd-cli, as applicable for this node.

!!!

