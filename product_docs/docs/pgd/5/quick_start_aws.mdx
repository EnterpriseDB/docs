---
title: "Deploying an EDB Postgres Distributed example cluster on AWS"
navTitle: "Deploying on AWS"
description: >
  A quick demonstration of deploying a PGD architecture using TPA on Amazon EC2
redirects:
  - /pgd/latest/deployments/tpaexec/quick_start/
  - /pgd/latest/tpa/quick_start/
---


The following steps set up EDB Postgres Distributed with an Always On Single Location
architecture using Amazon EC2.

## Prerequisites

You'll need to install and configure several software packages in order to complete this example. 

### EDB subscription

You'll need an EDB subscription in order to install TPA *and* in order to deploy PGD. You can [sign up for a trial account](https://www.enterprisedb.com/accounts/register) if you don't already have one. Then obtain your repository access token from [EDB Repos 2.0](https://www.enterprisedb.com/repos-downloads).

### Trusted Postgres Architect

We'll use the Trusted Postgres Architect (TPA) to provision and deploy PGD. You'll find instructions for installing it in the [Trusted Postgres Architect documentation](/tpa/latest/INSTALL/).

### Linux environment

[TPA supports several flavors of Linux](/tpa/latest/INSTALL/) as a host platform - you should have one of them at your disposal.

### AWS CLI

TPA will use the AWS CLI to provision and deploy. [Install the CLI](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html), and then [configure credentials](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-files.html) for an IAM user with sufficient access rights. The [TPA AWS Platform topic](/tpa/latest/platform-aws/) details the permissions that you'll need.

## Generate a configuration file:

Before starting out, set the `EDB_SUBSCRIPTION_TOKEN` environmental variable to your EDB repository access token.

```shell
export  EDB_SUBSCRIPTION_TOKEN=<token>
```

Then run `tpaexec configure` to generate a configuration folder.
   
```shell
tpaexec configure myedbdpcluster --architecture PGD-Always-ON --platform aws --location-names eu-west-1 --data-nodes-per-location 3 --no-git
```

This creates a subdirectory directory in current working directory called `myedbdpcluster` containing the `config.yml` configuration file TPA uses to create the cluster. Edit the `config.yml` as needed, for example to change the IP address range used for servers or adjust locations of nodes.

We included options to specify using AWS, a single location, and three data nodes. By default, PGD will also configure two [PGD Proxy](../routing/proxy/) nodes and a Barman node for backup.

For simplicity in this example, we're passing the `--no-git` flag - this will prevent TPA from trying to commit configuration changes to a Git repository. 

## Provision the cluster:
   
```shell
tpaexec provision myedbdpcluster
```
Since we specified AWS as the platform (the default platform), TPA provisions EC2 instances, VPCs, subnets, routing tables, internet gateways, security groups, EBS volumes, elastic IPs, and so on.

## Deploy the cluster: 

```shell
tpaexec deploy myedbdpcluster
```
TPA installs the needed packages, applies the configuration and sets up the actual EDB Postgres Distributed cluster

##  Test the cluster:

After the successful run of the `deploy` command the cluster is ready to use. You can connect to it via `psql` or any other database client.

It's also possible to run a test that ensures the cluster is running as expected:
```shell
tpaexec test myedbdpcluster
```


