---
title: pgd node setup
navTitle: setup
deepToC: true
---

## Synopsis

The `pgd node setup` command is used to configure PGD data nodes in a cluster. It can be used to set up a new node, join an existing node to a cluster, or perform a logical join of a node to the cluster.

The behavior of the command depends on the state of the local node and the remote node specified in the command.

If this is the first node in the cluster, `pgd node setup` will perform initdb and setup PGD node.

If this is not the first node, but the local node is not up and running, `pgd node setup` will perform a physical join of the node to the cluster. This will copy the data from the remote node to the local node as part of the initialization process, then join the local node to the cluster. This is the fastest way to load data into a new node.

If the local node is up and running and remote node also is reachable, `pgd node setup` will perform a logical join of the node to the cluster. This will create a new node in the cluster and start streaming replication from the remote node. This is the recommended way to add a new node to an existing cluster.

If the local node is up and running and remote node dsn is not provided, `pgd node setup` will do a node group switch if node not part of the given group.

## Syntax

```plaintext
pgd node <NODE_NAME> setup [OPTIONS] --pgdata <PG_DATA> <NODE_DSN>```
```

## Arguments

### <NODE_DSN>

DSN of the local node. This is the connection string to the local node. It is used to connect to the local node and perform the setup operation.
This is a mandatory argument and should be in the format `host=localhost port=5432 user=postgres dbname=bdrdb`.

## Options

| Option                 | Description                                                                                                                                   |
|------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|
| -D, --pgdata           | Data directory of the node.                                                                                                                   |
| --dbname               | DB name. Default is bdrdb.                                                                                                                    |
| --node-kind            | Node kind. Default is data. Applicable for first node only. [possible values: data, witness, subscriber-only]                                 |
| --group-name           | Node group name. If not provided, the node will be added to the group of the active node. It becomes a mandatory argument for the first node. |
| --create-group         | Set this to create the given group if not already present. This will be true by default for the first node.                                   |
| --cluster-name         | Name of the cluster to join the node to. This is a mandatory argument and is used as global group name for the first node of the cluster.     |
| --cluster-dsn          | A DSN to connect to active PGD cluster.                                                                                                       |
| --postgresql-conf      | Path of the postgresql.conf file to be used for the node.                                                                                     |
| --postgresql-auto-conf | Path of the postgresql.auto.conf file to be used for the node.                                                                                |
| --hba-conf             | Path of the pg_hba.conf file to be used for the node.                                                                                         |
| --debug                | Print debug messages, useful while troubleshooting.                                                                                           |
| -f, --config-file      | Sets the configuration file path.                                                                                                             |

See also [Global Options](/pgd/latest/cli/command_ref/#global-options).

## Examples

In these examples, we will set up a cluster with on three hosts, `host-1`, `host-2` and `host-3`, to create three nodes: `node-one`, `node-two`, and `node-three`.
The three nodes will be data nodes, and part a cluster named `dc1-cluster` with the group name `dc1`.

### Configuring the first node

```shell
pgd node node-one setup --pgdata /var/lib/edb-pge/17/main --group-name dc1 --cluster-name dc1-cluster --cluster-dsn "host=localhost port=5444 user=postgres dbname=bdrdb" --create-group
```

This command will create the first node named `node-one` in the cluster `dc1-cluster` with the group name `dc1`. The data directory for the node is set to `/var/lib/edb-pge/17/main`.

### Configuring the second node

```shell
pgd node node-two setup --pgdata /var/lib/edb-pge/17/main --group-name dc1 --cluster-name dc1-cluster --cluster-dsn "host= port=5444 user=postgres dbname=bdrdb" --create-group
```

